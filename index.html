<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Meeting Hub - Connect & Grow</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --info-gradient: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --shadow-light: 0 8px 32px rgba(31, 38, 135, 0.37);
            --button-disabled-bg: #ccc;
        }

        [data-theme="dark"] {
            --glass-bg: rgba(0, 0, 0, 0.25);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #f7fafc;
            --text-secondary: #e2e8f0;
            --button-disabled-bg: #555;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            color: var(--text-primary);
            transition: background 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
        }

        [data-theme="dark"] body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            padding: 2rem 1rem;
            margin-bottom: 2rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: var(--shadow-light);
            backdrop-filter: blur(10px);
        }

        .header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .header p { font-size: 1.1rem; opacity: 0.9; }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .control-btn {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .meeting-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 28px;
        }

        .meeting-box {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow-light);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }

        .meeting-box h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .content {
            flex-grow: 1;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .content ul { list-style-position: inside; padding-left: 10px; }
        .content p, .content ul { margin-bottom: 10px; }
        .content blockquote {
            font-style: italic;
            padding-left: 15px;
            border-left: 3px solid var(--text-secondary);
            margin-left: 0;
            opacity: 0.9;
        }
        
        .random-btn {
            background: var(--info-gradient);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95rem;
            align-self: flex-start;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .random-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .random-btn:disabled {
            background: var(--button-disabled-bg);
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.9);
            color: #2d3748;
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        [data-theme="dark"] .modal-content {
             background: rgba(40, 40, 60, 0.9);
             color: #f7fafc;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 25px;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        .modal-close:hover { transform: scale(1.2); }

        @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }

    </style>
</head>
<body>

    <div class="container">
        <header class="header">
            <h1>Family Meeting Hub</h1>
            <p>A place to connect, share, and grow together.</p>
        </header>

        <div class="controls">
            <button class="control-btn" onclick="showHelpModal()">‚ùì How to Use</button>
            <button class="control-btn" id="startBtn" onclick="startMeeting()">üöÄ New Meeting</button>
            <button class="control-btn" onclick="toggleTheme()"><span id="themeIcon">üåô</span> Toggle Theme</button>
        </div>

        <div class="meeting-grid">
            <div class="meeting-box">
                <h2>üíñ Check-In</h2>
                <div class="content">
                    <p>Go around and share using the **Rose, Bud, Thorn** format:</p>
                    <ul>
                        <li><strong>üåπ Rose:</strong> A highlight, success, or positive moment from the week.</li>
                        <li><strong>üå± Bud:</strong> Something you're looking forward to or a new idea.</li>
                        <li><strong>üåµ Thorn:</strong> A challenge you faced or something you need support with.</li>
                    </ul>
                </div>
            </div>

            <div class="meeting-box">
                <h2>üí° Amazing Fact</h2>
                <div class="content" id="interestingFact"><p>Ready to discover something incredible?</p></div>
                <button class="random-btn" id="btnFact" onclick="generateFact(this)">Discover Fact</button>
            </div>

            <div class="meeting-box">
                <h2>üéØ Ice Breaker</h2>
                <div class="content" id="iceBreaker"><p>Let's get the conversation flowing!</p></div>
                <button class="random-btn" id="btnIceBreaker" onclick="generateIceBreaker(this)">Get Question</button>
            </div>

            <div class="meeting-box">
                <h2>üí¨ Inspiring Quote</h2>
                <div class="content" id="famousQuote"><blockquote>An inspiring quote will appear here...</blockquote></div>
                <button class="random-btn" id="btnQuote" onclick="generateQuote(this)">Get Quote</button>
            </div>

            <div class="meeting-box">
                <h2>üìñ Story Time</h2>
                <div class="content" id="moralStory"><p>A meaningful story to share together...</p></div>
                <button class="random-btn" id="btnStory" onclick="generateStory(this)">Tell Story</button>
            </div>

            <div class="meeting-box">
                <h2>üõ†Ô∏è Life Skill</h2>
                <div class="content" id="lifeSkill"><p>Learn a valuable skill!</p></div>
                <button class="random-btn" id="btnSkill" onclick="generateSkill(this)">Learn Skill</button>
            </div>
            
            <div class="meeting-box">
                <h2>üòÇ Joke Time</h2>
                <div class="content" id="jokeContent"><p>Ready for a laugh?</p></div>
                <button class="random-btn" id="btnJoke" onclick="generateJoke(this)">Tell Joke</button>
            </div>

            <div class="meeting-box">
                <h2>üóìÔ∏è Upcoming Events</h2>
                <div class="content">
                    <p>Let's look at the week ahead:</p>
                    <ul>
                        <li>School events or projects?</li>
                        <li>Appointments or practices?</li>
                        <li>Family outings or special plans?</li>
                        <li>Chores or responsibilities?</li>
                    </ul>
                </div>
            </div>

            <div class="meeting-box">
                <h2>üìù Meeting Notes</h2>
                <div class="content">
                    <p>Capture important moments and decisions:</p>
                    <textarea class="notes-area" id="meetingNotes" placeholder="Write down key points..."></textarea>
                    <div style="margin-top: 16px; display: flex; gap: 12px; flex-wrap: wrap;">
                        <button class="random-btn" onclick="saveNotes()">üíæ Save Notes</button>
                        <button class="random-btn" onclick="loadNotes()">üìÇ Load Notes</button>
                        <button class="random-btn" onclick="exportNotes()">üìÑ Export</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeHelpModal()">&times;</span>
            <h2>Welcome to the Family Meeting Hub!</h2>
            <p>This tool is designed to make your family meetings more engaging, structured, and fun. Here‚Äôs how to use it:</p>
            <ol>
                <li><strong>Start Fresh:</strong> Click the "New Meeting" button to reset all the content cards.</li>
                <li><strong>Check-In First:</strong> Begin with the "Check-In" card. Go around the room and have each person share their "Rose" (a good thing), "Bud" (something they're looking forward to), and "Thorn" (a challenge).</li>
                <li><strong>Explore Topics:</strong> Work your way through the other cards like "Amazing Fact," "Ice Breaker," or "Story Time." Click the button on any card to generate a new, random prompt.</li>
                <li><strong>Plan Ahead:</strong> Use the "Upcoming Events" card to discuss the week's schedule and stay synchronized.</li>
                <li><strong>Take Notes:</strong> Use the "Meeting Notes" section to jot down important thoughts, decisions, or funny moments. You can save notes to your browser for next time or export them as a text file.</li>
            </ol>
        </div>
    </div>

    <script>
        // --- CONTENT ARRAYS (Static & API URLs) ---
        const API_URLS = {
            fact: 'https://uselessfacts.jsph.pl/random.json?language=en',
            quote: 'https://api.quotable.io/random',
            joke: 'https://official-joke-api.appspot.com/random_joke'
        };

        const allIceBreakers = [ "If you could have any superpower, what would it be and why?", "What is one thing you're grateful for today?", "What's the best thing that happened to you this week?" /* Add more */ ];
        const allStories = [ "The Boy Who Cried Wolf...", "The Tortoise and the Hare..." /* Add more */ ];
        const allSkills = [ { title: "How to Tie a Square Knot", steps: ["Right over left and under...", "Left over right and under..."] } /* Add more */ ];

        let usedContent = {};

        // --- CORE FUNCTIONS ---
        function initializeUsedContent() {
            usedContent = { iceBreakers: [], stories: [], skills: [] };
        }
        initializeUsedContent();

        function startMeeting() {
            // Reset content displays to their initial state
            document.getElementById('interestingFact').innerHTML = "<p>Ready to discover something incredible?</p>";
            document.getElementById('iceBreaker').innerHTML = "<p>Let's get the conversation flowing!</p>";
            document.getElementById('famousQuote').innerHTML = "<blockquote>An inspiring quote will appear here...</blockquote>";
            document.getElementById('moralStory').innerHTML = "<p>A meaningful story to share together...</p>";
            document.getElementById('lifeSkill').innerHTML = "<p>Learn a valuable skill!</p>";
            document.getElementById('jokeContent').innerHTML = "<p>Ready for a laugh?</p>";
            
            // Reset the used content trackers for static lists
            initializeUsedContent(); 
            alert("New meeting started! Content is refreshed.");
        }

        function setButtonLoadingState(button, isLoading, originalText) {
            if (isLoading) {
                button.disabled = true;
                button.textContent = 'Loading...';
            } else {
                button.disabled = false;
                button.textContent = originalText;
            }
        }

        // --- API-BASED GENERATORS ---
        async function fetchApiContent(url, button, originalText, formatter) {
            setButtonLoadingState(button, true, originalText);
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`Network response was not ok: ${response.statusText}`);
                const data = await response.json();
                return formatter(data);
            } catch (error) {
                console.error(`Failed to fetch from ${url}:`, error);
                return `<p>Oops! Couldn't fetch content. Please check your connection and try again.</p>`;
            } finally {
                setButtonLoadingState(button, false, originalText);
            }
        }

        async function generateFact(button) {
            const html = await fetchApiContent(API_URLS.fact, button, 'Discover Fact', data => `<p>${data.text}</p>`);
            document.getElementById('interestingFact').innerHTML = html;
        }

        async function generateQuote(button) {
            const html = await fetchApiContent(API_URLS.quote, button, 'Get Quote', data => `<blockquote>"${data.content}"<br><em>- ${data.author}</em></blockquote>`);
            document.getElementById('famousQuote').innerHTML = html;
        }
        
        async function generateJoke(button) {
            const html = await fetchApiContent(API_URLS.joke, button, 'Tell Joke', data => `<p><strong>${data.setup}</strong><br><em>${data.punchline}</em></p>`);
            document.getElementById('jokeContent').innerHTML = html;
        }

        // --- STATIC CONTENT GENERATORS ---
        function getRandomItem(itemType, itemsArray) {
            if (!itemsArray || itemsArray.length === 0) return null;
            let available = itemsArray.filter((_, i) => !usedContent[itemType].includes(i));
            if (available.length === 0) {
                // All items used, reset for this category and try again
                usedContent[itemType] = [];
                available = itemsArray;
            }
            const randomIndex = Math.floor(Math.random() * available.length);
            const item = available[randomIndex];
            // Find original index to mark as used
            const originalIndex = itemsArray.indexOf(item);
            usedContent[itemType].push(originalIndex);
            return item;
        }

        function generateStaticContent(button, originalText, itemType, array, elementId, formatter) {
            setButtonLoadingState(button, true, originalText);
            setTimeout(() => {
                const item = getRandomItem(itemType, array);
                const element = document.getElementById(elementId);
                element.innerHTML = item ? formatter(item) : `<p>Add more content to the list!</p>`;
                setButtonLoadingState(button, false, originalText);
            }, 200); // Simulate delay for better UX
        }
        
        function generateIceBreaker(button) {
            generateStaticContent(button, 'Get Question', 'iceBreakers', allIceBreakers, 'iceBreaker', item => `<p>${item}</p>`);
        }

        function generateStory(button) {
            generateStaticContent(button, 'Tell Story', 'stories', allStories, 'moralStory', item => `<p>${item}</p>`);
        }
        
        function generateSkill(button) {
            generateStaticContent(button, 'Learn Skill', 'skills', allSkills, 'lifeSkill', item => {
                let stepsHtml = item.steps.map(step => `<li>${step}</li>`).join('');
                return `<h3>${item.title}</h3><ol>${stepsHtml}</ol>`;
            });
        }
        
        // --- MODAL & THEME & NOTES FUNCTIONS ---
        function showHelpModal() { document.getElementById('helpModal').style.display = 'block'; }
        function closeHelpModal() { document.getElementById('helpModal').style.display = 'none'; }
        
        window.onclick = function(event) {
            const modal = document.getElementById('helpModal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
        
        function toggleTheme() {
            const body = document.documentElement;
            const currentTheme = body.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
                document.getElementById('themeIcon').textContent = 'üåô';
            } else {
                body.setAttribute('data-theme', 'dark');
                document.getElementById('themeIcon').textContent = '‚òÄÔ∏è';
            }
        }
        
        function saveNotes() {
            localStorage.setItem('familyMeetingNotes', document.getElementById('meetingNotes').value);
            alert('Notes saved to your browser!');
        }

        function loadNotes() {
            const savedNotes = localStorage.getItem('familyMeetingNotes');
            if (savedNotes) {
                document.getElementById('meetingNotes').value = savedNotes;
            } else {
                alert('No saved notes found.');
            }
        }

        function exportNotes() {
            const notes = document.getElementById('meetingNotes').value;
            const blob = new Blob([notes], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            const date = new Date().toISOString().slice(0, 10);
            link.download = `Meeting-Notes-${date}.txt`;
            link.href = URL.createObjectURL(blob);
            link.click();
            URL.revokeObjectURL(link.href);
        }

    </script>
</body>
</html>
