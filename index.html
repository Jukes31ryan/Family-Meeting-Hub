<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Deck</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); }

        /* --- THEME 1: DINNER TABLE (Modern Farmhouse: Navy & Cream) --- */
        body[data-mode="family"] { 
            /* Soft Silver/Blue Mist Background */
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            /* Deep Navy Header Gradient */
            --bg-gradient-accent: linear-gradient(to right, #243949 0%, #517fa4 100%);
            
            --glass-bg: rgba(255, 255, 255, 0.9);
            --text-main: #2c3e50; /* Deep Charcoal */
            --text-sub: #576574;
            --accent: #34495e; /* Slate Blue Accent */
            --border: #ffffff;
            --card-shadow: 0 8px 20px rgba(44, 62, 80, 0.15);
        }

        /* --- THEME 2: CAMPFIRE (Midnight & Embers: Dark, Glowing) --- */
        body[data-mode="friends"] { 
            /* Pitch Black Night Sky */
            --bg-gradient: linear-gradient(to bottom, #000000, #1a1a1a);
            /* Glowing Fire Text */
            --bg-gradient-accent: linear-gradient(to right, #ff9966, #ff5e62);
            
            --glass-bg: rgba(30, 30, 30, 0.8);
            --text-main: #f1f2f6;
            --text-sub: #a4b0be;
            --accent: #ff9f43; /* Fire Orange */
            --border: rgba(255, 159, 67, 0.2);
            --card-shadow: 0 0 20px rgba(255, 159, 67, 0.2); /* Glow Effect */
        }

        /* --- THEME 3: THE TEAM (Varsity: Electric Blue & Energy) --- */
        body[data-mode="work"] { 
            /* Deep Varsity Blue */
            --bg-gradient: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            /* Electric Blue/Cyan Header */
            --bg-gradient-accent: linear-gradient(to right, #00c6ff, #0072ff);
            
            --glass-bg: rgba(255, 255, 255, 0.95);
            --text-main: #1e272e;
            --text-sub: #57606f;
            --accent: #0984e3; /* Strong Team Blue */
            --border: #dcdde1;
            --card-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Outfit', sans-serif; 
            background: var(--bg-gradient);
            background-attachment: fixed;
            color: var(--text-main); 
            min-height: 100vh; 
            padding: 30px; 
            transition: var(--transition); 
            display: flex; 
            flex-direction: column;
        }

        .container { max-width: 1100px; margin: 0 auto; flex-grow: 1; width: 100%; }

        header { text-align: center; margin-bottom: 40px; }
        
        h1 { 
            font-weight: 800; 
            font-size: 3.5rem; 
            margin-bottom: 5px; 
            letter-spacing: -1px; 
            background: var(--bg-gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
            filter: drop-shadow(0px 2px 4px rgba(0,0,0,0.1));
        }
        
        .subtitle { font-size: 1.1rem; color: var(--text-sub); margin-bottom: 25px; font-weight: 600; opacity: 0.9; }

        /* TABS */
        .mode-tabs { background: var(--glass-bg); padding: 5px; border-radius: 50px; display: inline-flex; border: 1px solid var(--border); box-shadow: var(--card-shadow); backdrop-filter: blur(10px); }
        .tab-btn { background: transparent; border: none; padding: 10px 30px; border-radius: 30px; cursor: pointer; font-family: 'Outfit', sans-serif; font-weight: 700; color: var(--text-sub); transition: var(--transition); font-size: 0.95rem; }
        .tab-btn.active { background: var(--accent); color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        /* Text color adjustment for darker active tabs */
        body[data-mode="friends"] .tab-btn.active { color: #1e272e; } 

        /* GRID LAYOUT */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 24px; 
        }

        /* CARD STYLES */
        .card { 
            background: var(--glass-bg); 
            border: 1px solid var(--border); 
            border-radius: 24px; 
            padding: 25px; 
            display: flex; 
            flex-direction: column; 
            transition: var(--transition); 
            box-shadow: var(--card-shadow); 
            height: 100%; 
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(12px);
        }
        .card:hover { transform: translateY(-5px); border-color: var(--accent); }

        /* FEATURE CARD (Full Width) */
        .card-feature {
            grid-column: 1 / -1;
            background: var(--glass-bg);
            border: 2px solid var(--accent);
            padding: 40px;
        }
        .card-feature h3 { font-size: 1.8rem !important; margin-bottom: 20px !important; }
        .card-feature p { font-size: 1.2rem !important; line-height: 1.8 !important; }

        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .tag { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 800; color: var(--accent); opacity: 0.9; border: 1px solid var(--accent); padding: 4px 8px; border-radius: 6px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .card-content { flex-grow: 1; margin-bottom: 25px; font-size: 1.05rem; line-height: 1.5; color: var(--text-main); min-height: 60px; display: flex; align-items: center; animation: fadeIn 0.4s ease-out; }
        .card-content p { width: 100%; }
        .card-content h3 { color: var(--accent); margin-bottom: 10px; font-size: 1.2rem; font-weight: 800; }
        
        /* CHEAT CODE / PLAYBOOK BOX STYLE */
        .cheat-code-box {
            background: rgba(125,125,125,0.1); 
            border-left: 6px solid var(--accent);
            padding: 20px;
            margin-top: 25px;
            border-radius: 0 12px 12px 0;
            font-weight: 500;
            font-size: 1.1rem;
        }

        .check-list { list-style: none; width: 100%; }
        .check-list li { padding: 12px 0; border-bottom: 1px solid var(--border); font-size: 0.95rem; color: var(--text-main); display: flex; gap: 10px; }
        .check-list li:last-child { border-bottom: none; }

        /* BUTTONS */
        .btn { background: var(--text-main); color: var(--glass-bg); border: none; width: 100%; padding: 14px; border-radius: 14px; font-weight: 700; font-family: 'Outfit', sans-serif; cursor: pointer; transition: var(--transition); }
        .btn:hover { background: var(--accent); color: white; transform: translateY(-2px); }
        
        /* Adjust button text color for Campfire mode */
        body[data-mode="friends"] .btn { color: #1a1a1a; }
        body[data-mode="friends"] .btn:hover { color: #1a1a1a; }
        /* Adjust for Work mode */
        body[data-mode="work"] .btn:hover { color: #ffffff; }

        .btn:active { transform: scale(0.98); }

        .counter-group { display: flex; align-items: center; gap: 10px; width: 100%; margin-top: auto;}
        .counter-btn { width: 45px; height: 45px; border-radius: 12px; background: transparent; border: 2px solid var(--border); font-size: 1.2rem; font-weight: bold; color: var(--text-main); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: var(--transition); }
        .counter-btn:hover { border-color: var(--accent); color: var(--accent); background: rgba(255,255,255,0.05); }
        .counter-val { flex-grow: 1; text-align: center; font-size: 1.1rem; font-weight: 800; }

        /* SPONSOR */
        .sponsor-area { margin-top: 50px; text-align: center; padding-bottom: 20px; }
        .sponsor-link { color: var(--accent); font-weight: 700; text-decoration: none; margin-left: 5px; opacity: 0.8; font-size: 1.1rem; }
        .sponsor-link:hover { text-decoration: underline; opacity: 1; }

        @media (max-width: 768px) { 
            h1 { font-size: 2.5rem; } 
            .mode-tabs { width: 100%; display: flex; } 
            .tab-btn { flex: 1; padding: 12px 0; } 
            .card-feature { padding: 25px; }
        }
    </style>
</head>
<body data-mode="family">

    <div class="container">
        <header>
            <h1 id="app-title">Home Deck</h1>
            <p class="subtitle" id="app-subtitle">Meaningful conversations, no screens required.</p>
            
            <div class="mode-tabs">
                <button class="tab-btn active" onclick="setMode('family')" id="tab-family">Home</button>
                <button class="tab-btn" onclick="setMode('friends')" id="tab-friends">Social</button>
                <button class="tab-btn" onclick="setMode('work')" id="tab-work">Team</button>
            </div>
        </header>

        <div class="grid">
            
            <div class="card">
                <div class="card-header"><span class="tag" id="tag-1">Warm Up</span></div>
                <div class="card-content" id="content-iceBreaker"><p>Loading...</p></div>
                <button class="btn" onclick="generate('iceBreaker')" id="btn-1">Next Question</button>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag" id="tag-2">Check In</span></div>
                <div class="card-content" style="display:block;">
                    <ul class="check-list" id="list-checkin"></ul>
                </div>
                <div class="counter-group">
                    <button class="counter-btn" onclick="adjustCount(-1)">-</button>
                    <span class="counter-val" id="count-display">4 People</span>
                    <button class="counter-btn" onclick="adjustCount(1)">+</button>
                    <button class="btn" style="width: auto;" onclick="generateOrder()">Order</button>
                </div>
                <div id="checkInOrder" style="margin-top: 10px; font-weight: bold; color: var(--accent); font-size: 0.9rem; text-align: center;"></div>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag" id="tag-3">Wisdom</span></div>
                <div class="card-content" id="content-quote"><p>Loading...</p></div>
                <button class="btn" onclick="generate('quote')" id="btn-3">Next Quote</button>
            </div>

            <div class="card card-feature">
                <div class="card-header"><span class="tag" id="tag-4">Lesson</span></div>
                <div class="card-content" id="content-dynamic" style="display: block;"><p>Loading...</p></div>
                <button class="btn" onclick="generate('dynamic')" id="btn-4" style="width: auto; margin: 0 auto; display: block; padding: 15px 40px;">Read Next Lesson</button>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag">Humor</span></div>
                <div class="card-content" id="content-joke"><p>Loading...</p></div>
                <button class="btn" onclick="generateJoke()">Next Joke</button>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag" id="tag-6">Growth</span></div>
                <div class="card-content" id="content-skill"><p>Loading...</p></div>
                <button class="btn" onclick="generate('skill')" id="btn-6">Next Skill</button>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag">Wonder</span></div>
                <div class="card-content" id="content-fact"><p>Loading...</p></div>
                <button class="btn" onclick="generateFact()">Get Fact</button>
            </div>

        </div>

        <div class="sponsor-area">
            <span id="ad-text" style="opacity: 0.6; font-size: 0.8rem;">Brought to you by</span><br>
            <a href="https://noblerealtywv.com" target="_blank" class="sponsor-link" id="ad-link">Noble Realty WV &rarr;</a>
            <div style="margin-top: 5px; font-size: 0.8rem; opacity: 0.7;">Serving Community Heroes First.</div>
        </div>
    </div>

<script src="data.js"></script>
<script>
    let currentMode = 'family';
    let participants = 4;
    let usedIndices = { iceBreaker: [], quote: [], dynamic: [], skill: [] };

    window.onload = () => {
        const savedMode = localStorage.getItem('meetingMode');
        if(savedMode && db[savedMode]) {
            setMode(savedMode);
        } else {
            setMode('family');
        }
    };

    function setMode(mode) {
        currentMode = mode;
        localStorage.setItem('meetingMode', mode);
        document.body.setAttribute('data-mode', mode);
        
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('tab-' + mode).classList.add('active');

        const d = db[mode];
        document.getElementById('app-title').innerText = d.title;
        document.getElementById('app-subtitle').innerText = d.subtitle;
        
        document.getElementById('tag-1').innerText = d.tags[0];
        document.getElementById('tag-2').innerText = d.tags[1];
        document.getElementById('tag-3').innerText = d.tags[2];
        document.getElementById('tag-4').innerText = d.tags[3];
        document.getElementById('tag-6').innerText = d.tags[5];
        
        document.getElementById('btn-1').innerText = d.btns[0];
        document.getElementById('btn-3').innerText = d.btns[2];
        document.getElementById('btn-4').innerText = d.btns[3];
        document.getElementById('btn-6').innerText = d.btns[5];

        const list = document.getElementById('list-checkin');
        list.innerHTML = '';
        d.checkin.forEach(item => {
            const li = document.createElement('li');
            li.innerHTML = item;
            list.appendChild(li);
        });

        document.getElementById('checkInOrder').innerText = "";
        document.getElementById('ad-text').innerText = d.ad_text;
        document.getElementById('ad-link').innerText = d.ad_link;

        usedIndices = { iceBreaker: [], quote: [], dynamic: [], skill: [] };

        generate('iceBreaker');
        generate('quote');
        generate('dynamic');
        generate('skill');
        generateJoke();
        generateFact();
    }

    function generate(type) {
        const d = db[currentMode];
        let pool = [];
        
        if (type === 'iceBreaker') pool = d.iceBreakers;
        else if (type === 'quote') pool = d.quotes;
        else if (type === 'dynamic') pool = d.dynamics;
        else if (type === 'skill') pool = d.skills;

        if (!pool || pool.length === 0) return;

        let index;
        let attempts = 0;
        do {
            index = Math.floor(Math.random() * pool.length);
            attempts++;
            if (usedIndices[type].length >= pool.length) { usedIndices[type] = []; break; }
        } while (usedIndices[type].includes(index) && attempts < 100);
        
        usedIndices[type].push(index);
        const item = pool[index];
        const container = document.getElementById('content-' + type);

        const newContainer = container.cloneNode(false);

        if (type === 'quote') {
            newContainer.innerHTML = `<p class="quote-style">"${item.text}"<br><span style="font-size:0.85rem; font-weight:normal;">- ${item.author}</span></p>`;
        } else if (typeof item === 'string') {
            newContainer.innerHTML = `<p>${item}</p>`;
        } else {
            newContainer.innerHTML = `<h3>${item.title}</h3><p>${item.body}</p>`;
        }

        container.parentNode.replaceChild(newContainer, container);
    }

    function generateJoke() {
        const container = document.getElementById('content-joke');
        const newContainer = container.cloneNode(false);
        newContainer.innerHTML = "Thinking...";
        container.parentNode.replaceChild(newContainer, container);

        fetch('https://official-joke-api.appspot.com/random_joke')
            .then(r => r.json())
            .then(data => { newContainer.innerHTML = `<p><strong>${data.setup}</strong><br><em>${data.punchline}</em></p>`; })
            .catch(() => { newContainer.innerHTML = "<p>Why did the developer go broke? He used up all his cache.</p>"; });
    }

    function generateFact() {
        const container = document.getElementById('content-fact');
        const newContainer = container.cloneNode(false);
        newContainer.innerHTML = "Thinking...";
        container.parentNode.replaceChild(newContainer, container);

        fetch('https://uselessfacts.jsph.pl/random.json?language=en')
            .then(r => r.json())
            .then(data => { newContainer.innerHTML = `<p>${data.text}</p>`; })
            .catch(() => { newContainer.innerHTML = "<p>Honey never spoils. Archaeologists have found pots of honey in ancient Egyptian tombs that are over 3,000 years old and still edible.</p>"; });
    }

    function adjustCount(change) {
        participants += change;
        if (participants < 2) participants = 2;
        if (participants > 20) participants = 20;
        document.getElementById('count-display').innerText = participants + " People";
    }

    function generateOrder() {
        let arr = [];
        for(let i=1; i<=participants; i++) arr.push(i);
        arr.sort(() => Math.random() - 0.5);
        document.getElementById('checkInOrder').innerText = "Order: Person " + arr.join(" â†’ ");
    }
</script>

</body>
</html>