<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Lanturn ‚Äî A Brighter Way to Check In</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,600&family=Nunito:wght@400;600&display=swap" rel="stylesheet">
<style>
/* THEME: ENCHANTED MOONLIGHT 
   Inspired by: Deep blues, mist, glowing cyan moon
*/

*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
html, body {
  height:100%; width:100%; overflow:hidden;
  font-family:'Nunito', sans-serif;
  -webkit-font-smoothing:antialiased;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  color:#E0F7FA; /* Cool white text */
}

/* BACKGROUND LAYERS - Shifted to Deep Blue/Cyan */
.bg-layer {
  position:fixed; inset:0;
  transition:opacity 1.2s ease;
}
#bg-a { z-index:1; }
#bg-b { z-index:2; opacity:0; }

/* Base Gradient structure */
.bg--base { background: linear-gradient(180deg, #020c1b 0%, #051626 40%, #0a2e36 100%); }

/* Subtle variations per screen */
.bg--home       { background: linear-gradient(180deg, #020c1b 0%, #051626 40%, #0a2e36 100%); }
.bg--icebreaker { background: linear-gradient(180deg, #041021 0%, #092036 40%, #0e3d45 100%); }
.bg--quote      { background: linear-gradient(180deg, #070d1f 0%, #0f2238 40%, #13404a 100%); }
.bg--checkin    { background: linear-gradient(180deg, #06121f 0%, #0e2b33 40%, #16454d 100%); }
.bg--story      { background: linear-gradient(180deg, #0b1026 0%, #14243d 40%, #1b4a52 100%); }
.bg--lesson     { background: linear-gradient(180deg, #0d1429 0%, #162b45 40%, #1f5057 100%); }
.bg--mindful    { background: linear-gradient(180deg, #050b14 0%, #0b1e2e 40%, #10333b 100%); }
.bg--joke       { background: linear-gradient(180deg, #0f1229 0%, #1c2b45 40%, #225259 100%); }
.bg--close      { background: linear-gradient(180deg, #020c1b 0%, #051626 40%, #0a2e36 100%); }

/* MOON - Updated to match image (Cooler/Cyan Glow) */
.moon {
  position:fixed;
  top:50px; right:30px;
  width:90px; height:90px;
  border-radius:50%;
  background: radial-gradient(circle at 35% 35%, #FFFFFF, #E0F7FA 60%, #B2EBF2);
  box-shadow: 
    0 0 30px rgba(178,235,242,0.6), /* Inner Glow */
    0 0 80px rgba(178,235,242,0.3), /* Outer Glow */
    0 0 140px rgba(178,235,242,0.1); /* Haze */
  z-index:5;
  animation: moonPulse 8s ease-in-out infinite;
}
@keyframes moonPulse {
  0%, 100% { box-shadow: 0 0 30px rgba(178,235,242,0.6), 0 0 80px rgba(178,235,242,0.3); }
  50% { box-shadow: 0 0 45px rgba(178,235,242,0.8), 0 0 100px rgba(178,235,242,0.4); }
}

/* RIVER/MIST - Bottom Reflection */
.river {
  position:fixed;
  bottom:0; left:0; right:0;
  height:140px;
  background: linear-gradient(180deg, 
    transparent 0%,
    rgba(178,235,242,0.05) 30%,
    rgba(178,235,242,0.15) 100%);
  z-index:4;
  pointer-events: none;
}
.river::before {
  content:'';
  position:absolute;
  top:30px; left:50%; transform:translateX(-50%);
  width:160px; height:40px;
  background: radial-gradient(ellipse, rgba(255,255,255,0.2) 0%, transparent 70%);
  filter: blur(8px);
  animation: moonReflection 5s ease-in-out infinite;
}
@keyframes moonReflection {
  0%, 100% { opacity:0.5; transform:translateX(-50%) scaleX(1); }
  50% { opacity:0.8; transform:translateX(-50%) scaleX(1.1); }
}

/* FIREFLIES/STARS */
#fireflies { position:fixed; inset:0; z-index:6; pointer-events:none; }
.firefly {
  position:absolute;
  border-radius:50%;
  background: white;
  animation: fireflyFloat linear infinite;
}

@keyframes fireflyFloat {
  0% { transform:translate(0, 0) scale(1); opacity:0; }
  20% { opacity:0.8; }
  100% { transform:translate(20px, -100px) scale(0.5); opacity:0; }
}

/* UI ELEMENTS */
.screen {
  position:fixed; inset:0; z-index:10;
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  padding:80px 24px 60px;
  opacity:0; pointer-events:none;
  transition:opacity 0.6s ease;
  overflow-y:auto;
}
.screen.active { opacity:1; pointer-events:auto; }

.anim-in {
  opacity:0; transform:translateY(15px);
  transition:opacity 0.7s ease, transform 0.7s ease;
}
.screen.active .anim-in { opacity:1; transform:translateY(0); }
/* Stagger delays for smooth entrance */
.screen.active .anim-in:nth-child(1) { transition-delay:0.1s; }
.screen.active .anim-in:nth-child(2) { transition-delay:0.2s; }
.screen.active .anim-in:nth-child(3) { transition-delay:0.3s; }
.screen.active .anim-in:nth-child(4) { transition-delay:0.4s; }

/* NAVIGATION CHROME */
#top-chrome {
  position:fixed; top:0; left:0; right:0; z-index:100;
  display:flex; align-items:center; justify-content:space-between;
  padding:24px;
  opacity:0; pointer-events:none;
  transition:opacity 0.3s ease;
}
#top-chrome.visible { opacity:1; pointer-events:auto; }

.nav-btn {
  background:none; border:none;
  color:rgba(224,247,250,0.6);
  font-size:1.2rem; cursor:pointer;
  transition:color 0.2s;
}
.nav-btn:hover { color:#fff; }

.dots { display:flex; gap:8px; }
.dot {
  width:6px; height:6px; border-radius:50%;
  background:rgba(224,247,250,0.2);
  transition:all 0.3s;
}
.dot.active { background:#80DEEA; transform:scale(1.2); box-shadow:0 0 8px #80DEEA; }
.dot.done { background:rgba(128,222,234,0.4); }

/* HOME SCREEN */
.lantern-logo {
  font-size:4rem; 
  filter:drop-shadow(0 0 20px rgba(128,222,234,0.6));
  animation: floatLogo 4s ease-in-out infinite;
  margin-bottom:20px;
}
@keyframes floatLogo {
  0%, 100% { transform:translateY(0); }
  50% { transform:translateY(-10px); }
}

.title-main {
  font-family:'Cormorant Garamond', serif;
  font-size:3.5rem; font-weight:600;
  letter-spacing:0.02em; color:#fff;
  text-shadow:0 0 20px rgba(128,222,234,0.4);
}
.title-sub {
  font-size:1.1rem; color:rgba(224,247,250,0.7);
  font-weight:400; margin-top:-5px; margin-bottom:40px;
}

.btn-start {
  padding:18px 50px; border-radius:50px;
  background:rgba(128,222,234,0.15);
  border:1px solid rgba(128,222,234,0.4);
  backdrop-filter:blur(10px);
  color:#fff; font-family:'Cormorant Garamond', serif;
  font-size:1.4rem; font-weight:600; letter-spacing:0.05em;
  cursor:pointer; transition:all 0.3s ease;
  box-shadow:0 0 20px rgba(128,222,234,0.1);
}
.btn-start:hover {
  background:rgba(128,222,234,0.25);
  box-shadow:0 0 30px rgba(128,222,234,0.3);
  transform:scale(1.02);
}

/* CONTENT STYLES */
.label-top {
  font-size:0.8rem; text-transform:uppercase; letter-spacing:0.15em;
  color:#80DEEA; margin-bottom:20px; font-weight:700;
  opacity:0.8;
}

.card-text-lg {
  font-family:'Cormorant Garamond', serif;
  font-size:2rem; line-height:1.3; text-align:center;
  color:#fff; margin-bottom:10px;
}
.card-text-md {
  font-size:1.1rem; line-height:1.6; text-align:center;
  color:rgba(224,247,250,0.9); max-width:600px;
}

/* STORY SCROLL AREA */
.story-scroll {
  max-height:40vh; overflow-y:auto;
  padding-right:10px; margin-bottom:20px;
  text-align:left;
  /* Scrollbar styling */
  scrollbar-width: thin;
  scrollbar-color: rgba(128,222,234,0.3) transparent;
}
.story-scroll::-webkit-scrollbar { width:4px; }
.story-scroll::-webkit-scrollbar-thumb { background:rgba(128,222,234,0.3); border-radius:4px; }

.moral-box {
  background:rgba(128,222,234,0.1);
  border-left:2px solid #80DEEA;
  padding:15px; border-radius:0 8px 8px 0;
  margin-top:20px; font-style:italic;
  color:#E0F7FA;
}

/* ACTION BUTTONS (Bottom Row) */
.action-row {
  display:flex; gap:15px; width:100%; max-width:340px;
  margin-top:40px; justify-content:center; align-items:center;
}

/* THE PRIMARY "CONTINUE" BUTTON */
.btn-continue {
  position:fixed; bottom:40px;
  padding:16px 40px; border-radius:50px;
  background:#E0F7FA; color:#051626;
  font-weight:700; font-size:1rem; border:none;
  cursor:pointer; box-shadow:0 10px 30px rgba(0,0,0,0.3);
  transition:transform 0.2s;
  z-index:20;
}
.btn-continue:active { transform:scale(0.95); }

/* SECONDARY ACTIONS (Refresh / Heart) */
.btn-icon-group {
  display:flex; gap:12px;
  margin-top:30px;
}

.btn-icon {
  width:44px; height:44px; border-radius:50%;
  background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.2);
  color:rgba(255,255,255,0.7);
  font-size:1.2rem; cursor:pointer;
  display:flex; align-items:center; justify-content:center;
  transition:all 0.2s ease;
}
.btn-icon:hover { background:rgba(255,255,255,0.15); color:#fff; }
.btn-icon:active { transform:scale(0.9); }

/* Heart Toggle State */
.btn-icon.saved {
  background:rgba(255,100,100,0.2);
  border-color:rgba(255,100,100,0.5);
  color:#ff6b6b;
  animation: heartPop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
@keyframes heartPop {
  0% { transform:scale(1); }
  50% { transform:scale(1.3); }
  100% { transform:scale(1); }
}

/* Reveal Button for Joke */
.btn-reveal {
  background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.3);
  color:#fff; padding:10px 24px; border-radius:20px;
  cursor:pointer; margin-top:20px; font-family:'Cormorant Garamond', serif;
  font-size:1.1rem;
}

</style>
</head>
<body>

<div class="bg-layer bg--home" id="bg-a"></div>
<div class="bg-layer bg--home" id="bg-b"></div>

<div class="moon"></div>
<div class="river"></div>
<div id="fireflies"></div>

<div id="top-chrome">
  <button class="nav-btn" onclick="goBack()">‚Üê</button>
  <div class="dots" id="dots-container"></div>
  <button class="nav-btn" onclick="goHome()">‚úï</button>
</div>

<div class="screen active" id="screen-home">
  <div class="lantern-logo anim-in">üèÆ</div>
  <div class="title-main anim-in">Lanturn</div>
  <div class="title-sub anim-in">A brighter way to check in</div>
  <button class="btn-start anim-in" onclick="startSession()">Begin</button>
</div>

<div class="screen" id="screen-icebreaker">
  <div class="label-top anim-in">Ice Breaker</div>
  <div class="card-text-lg anim-in" id="ib-text">Loading...</div>
  
  <div class="btn-icon-group anim-in">
    <button class="btn-icon" onclick="oneMore('icebreaker')">‚Üª</button>
    <button class="btn-icon" onclick="toggleSave(this)">‚ô°</button>
  </div>
  
  <button class="btn-continue" onclick="goToAct(2)">Continue</button>
</div>

<div class="screen" id="screen-quote">
  <div class="label-top anim-in">Perspective</div>
  <div style="font-size:4rem; line-height:0.5; color:#80DEEA; opacity:0.5; margin-bottom:20px;" class="anim-in">"</div>
  <div class="card-text-lg anim-in" style="font-style:italic;" id="qt-text"></div>
  <div class="anim-in" style="margin-top:20px; color:#80DEEA; font-weight:600;" id="qt-author"></div>
  
  <div class="btn-icon-group anim-in">
    <button class="btn-icon" onclick="oneMore('quote')">‚Üª</button>
    <button class="btn-icon" onclick="toggleSave(this)">‚ô°</button>
  </div>
  
  <button class="btn-continue" onclick="goToAct(3)">Continue</button>
</div>

<div class="screen" id="screen-checkin">
  <div class="label-top anim-in">Check In</div>
  
  <div class="anim-in" style="background:rgba(255,255,255,0.05); padding:20px; border-radius:12px; width:100%; max-width:400px; margin-bottom:10px; border-left:3px solid #80DEEA;">
    <div style="font-size:0.8rem; color:#80DEEA; margin-bottom:5px;">GRATITUDE</div>
    <div style="font-size:1.1rem;" id="ci-grat"></div>
  </div>

  <div class="anim-in" style="background:rgba(255,255,255,0.05); padding:20px; border-radius:12px; width:100%; max-width:400px; border-left:3px solid #C4B7EB;">
    <div style="font-size:0.8rem; color:#C4B7EB; margin-bottom:5px;">INTENTION</div>
    <div style="font-size:1.1rem;" id="ci-goal"></div>
  </div>

  <div class="btn-icon-group anim-in">
    <button class="btn-icon" onclick="oneMore('checkin')">‚Üª</button>
  </div>
  
  <button class="btn-continue" onclick="goToAct(4)">Continue</button>
</div>

<div class="screen" id="screen-story">
  <div class="label-top anim-in">Story</div>
  <div class="card-text-lg anim-in" style="font-size:1.8rem; margin-bottom:20px;" id="story-title"></div>
  
  <div class="story-scroll anim-in">
    <div id="story-body" style="font-size:1.1rem; line-height:1.7; color:rgba(255,255,255,0.9);"></div>
    <div class="moral-box" id="story-moral"></div>
  </div>

  <div class="btn-icon-group anim-in">
    <button class="btn-icon" onclick="oneMore('story')">‚Üª</button>
    <button class="btn-icon" onclick="toggleSave(this)">‚ô°</button>
  </div>
  
  <button class="btn-continue" onclick="goToAct(5)">Continue</button>
</div>

<div class="screen" id="screen-lesson">
  <div class="label-top anim-in">Skill</div>
  <div class="anim-in" style="color:#80DEEA; font-size:3rem; margin-bottom:10px;" id="les-icon"></div>
  <div class="card-text-lg anim-in" style="font-size:1.6rem;" id="les-title"></div>
  <div class="card-text-md anim-in" style="text-align:left; margin-top:15px;" id="les-body"></div>

  <div class="btn-icon-group anim-in">
    <button class="btn-icon" onclick="oneMore('lesson')">‚Üª</button>
    <button class="btn-icon" onclick="toggleSave(this)">‚ô°</button>
  </div>
  
  <button class="btn-continue" onclick="goToAct(6)">Continue</button>
</div>

<div class="screen" id="screen-mindful">
  <div class="label-top anim-in">Breathe</div>
  <div class="card-text-md anim-in">Take 30 seconds. Close your eyes. Just be here.</div>
  
  <div class="anim-in" style="font-family:'Cormorant Garamond'; font-size:5rem; margin:30px 0; font-variant-numeric:tabular-nums;" id="mindful-timer">0:30</div>
  
  <button class="btn-reveal anim-in" id="btn-mindful" onclick="startMindful()">Start Timer</button>
  
  <button class="btn-continue" style="display:none;" id="mindful-cont" onclick="goToAct(7)">Continue</button>
</div>

<div class="screen" id="screen-joke">
  <div class="label-top anim-in">Smile</div>
  <div class="card-text-lg anim-in" id="jk-setup"></div>
  
  <button class="btn-reveal anim-in" id="btn-reveal" onclick="revealJoke()">Reveal</button>
  
  <div id="pk-wrap" style="display:none; margin-top:30px; flex-direction:column; align-items:center;">
    <div style="width:50px; height:2px; background:#fff; opacity:0.3; margin-bottom:20px;"></div>
    <div class="card-text-lg" style="color:#80DEEA;" id="jk-punch"></div>
  </div>

  <div class="btn-icon-group anim-in" style="margin-top:40px;">
    <button class="btn-icon" onclick="oneMore('joke')">‚Üª</button>
  </div>
  
  <button class="btn-continue" onclick="goToAct(8)">Finish</button>
</div>

<div class="screen" id="screen-close">
  <div class="lantern-logo anim-in">üèÆ</div>
  <div class="card-text-lg anim-in">Session Complete</div>
  <div class="card-text-md anim-in">You took time to connect today.<br>That matters.</div>
  <button class="btn-start anim-in" style="margin-top:40px;" onclick="goHome()">Home</button>
</div>

<script>
// DATA (Shortened for brevity in this block, assume full data exists or paste D object here)
const D = {
  ib: [
    "If you could have dinner with anyone, living or dead, who would it be?",
    "What's a skill you'd love to learn?",
    "What's the best trip you've ever taken?",
    "If you could live anywhere in the world, where would it be?",
    "What's a movie you could watch over and over?"
  ],
  qt: [
    {t:"The best time to plant a tree was 20 years ago. The second best time is now.",a:"Chinese Proverb"},
    {t:"Be the change you wish to see in the world.",a:"Mahatma Gandhi"}
  ],
  gr: ["What's one thing you're grateful for today?", "Who made a difference for you recently?"],
  gl: ["What's one thing you want to focus on this week?", "What's a habit you want to build?"],
  st: [
    {t:"The Two Wolves",s:"A grandfather tells his grandson about two wolves fighting inside everyone ‚Äî one is anger, the other is joy. The grandson asks which wolf wins. The grandfather replies: 'The one you feed.'",m:"We become what we focus on."}
  ],
  ls: [
    {c:"Self Care",i:"üíÜ",t:"How to Calm Down",b:"Stop and name what you're feeling. Take 5 slow breaths: in for 4, hold for 4, out for 6. Ground yourself by naming 5 things you can see."}
  ],
  jk: [
    {s:"Why don't scientists trust atoms?",p:"Because they make up everything!"}
  ]
};

// --- LOGIC ---

let S = { act: 0 };
let mindfulInterval = null;

// Fireflies Logic
(function() {
  const c = document.getElementById('fireflies');
  for(let i=0; i<15; i++){
    let d = document.createElement('div');
    d.className='firefly';
    d.style.left = Math.random()*100 + '%';
    d.style.top = Math.random()*100 + '%';
    d.style.animationDuration = (Math.random()*10 + 5) + 's';
    d.style.animationDelay = (Math.random()*5) + 's';
    d.style.width = d.style.height = (Math.random()*4 + 2) + 'px';
    c.appendChild(d);
  }
})();

function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

function toggleSave(btn) {
  btn.classList.toggle('saved');
  btn.innerHTML = btn.classList.contains('saved') ? '‚ô•' : '‚ô°';
}

function setBg(key) {
  // Simplification: Keeping basic deep blue gradient for now to ensure smoothness
  // In a full version, we'd swap classes on bg-layers
}

function show(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  setTimeout(() => document.getElementById(id).classList.add('active'), 50);
}

function updateDots(n) {
  const c = document.getElementById('dots-container');
  c.innerHTML = '';
  for(let i=1; i<=8; i++) {
    let d = document.createElement('div');
    d.className = 'dot ' + (i===n ? 'active' : (i<n ? 'done' : ''));
    c.appendChild(d);
  }
}

function goHome() {
  S.act = 0;
  document.getElementById('top-chrome').classList.remove('visible');
  document.querySelector('.btn-continue').style.display = 'none';
  show('screen-home');
}

function goBack() {
  if(S.act <= 1) goHome();
  else goToAct(S.act - 1);
}

function goToAct(n) {
  S.act = n;
  const screens = ['home','icebreaker','quote','checkin','story','lesson','mindful','joke','close'];
  
  if(n===0) { goHome(); return; }
  
  document.getElementById('top-chrome').classList.add('visible');
  updateDots(n);
  show('screen-' + screens[n]);
  
  // Logic to show/hide the main Continue button
  const btn = document.querySelector('.btn-continue');
  btn.style.display = (n === 7 || n === 9) ? 'none' : 'block'; // Hide on Mindful(7) until done, Hide on Close(9)

  if(n===1) loadIB();
  if(n===2) loadQT();
  if(n===3) loadCI();
  if(n===4) loadST();
  if(n===5) loadLS();
  if(n===6) loadMF();
  if(n===7) loadJK();
}

function startSession() { goToAct(1); }

function oneMore(type) {
  if(type==='icebreaker') loadIB();
  if(type==='quote') loadQT();
  if(type==='checkin') loadCI();
  if(type==='story') loadST();
  if(type==='lesson') loadLS();
  if(type==='joke') loadJK();
  
  // Reset hearts on refresh
  document.querySelectorAll('.btn-icon.saved').forEach(b => {
    b.classList.remove('saved');
    b.innerHTML = '‚ô°';
  });
}

function loadIB() { document.getElementById('ib-text').innerText = pick(D.ib); }
function loadQT() { 
  let q = pick(D.qt);
  document.getElementById('qt-text').innerText = q.t;
  document.getElementById('qt-author').innerText = "- " + q.a;
}
function loadCI() {
  document.getElementById('ci-grat').innerText = pick(D.gr);
  document.getElementById('ci-goal').innerText = pick(D.gl);
}
function loadST() {
  let s = pick(D.st);
  document.getElementById('story-title').innerText = s.t;
  document.getElementById('story-body').innerText = s.s;
  document.getElementById('story-moral').innerText = "Moral: " + s.m;
}
function loadLS() {
  let l = pick(D.ls);
  document.getElementById('les-icon').innerText = l.i;
  document.getElementById('les-title').innerText = l.t;
  document.getElementById('les-body').innerText = l.b;
}
function loadMF() {
  document.getElementById('mindful-timer').innerText = "0:30";
  document.getElementById('btn-mindful').style.display = "block";
  document.getElementById('mindful-cont').style.display = "none";
}
function startMindful() {
  document.getElementById('btn-mindful').style.display = "none";
  let t = 30;
  mindfulInterval = setInterval(() => {
    t--;
    document.getElementById('mindful-timer').innerText = "0:" + (t<10?"0":"") + t;
    if(t<=0) {
      clearInterval(mindfulInterval);
      document.getElementById('mindful-cont').style.display = "block";
    }
  }, 1000);
}
function loadJK() {
  let j = pick(D.jk);
  document.getElementById('jk-setup').innerText = j.s;
  document.getElementById('jk-punch').innerText = j.p;
  document.getElementById('btn-reveal').style.display = "block";
  document.getElementById('pk-wrap').style.display = "none";
  document.querySelector('.btn-continue').style.display = "none"; // Hide continue until punchline
}
function revealJoke() {
  document.getElementById('btn-reveal').style.display = "none";
  document.getElementById('pk-wrap').style.display = "flex";
  document.querySelector('.btn-continue').style.display = "block";
}

</script>
</body>
</html>
