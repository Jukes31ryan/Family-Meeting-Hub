// --- UPDATED LIBRARY WITH BUSINESS MODE ---
const LIBRARY = {
    nest: {
        bg: 'linear-gradient(135deg, #FF9A9E 0%, #FAD0C4 100%)', // Soft Pink/Peach
        icebreakers: ["If you could be any animal for a day, which one?", "What's the best superpower for a kid?", "What is your favorite dessert?"],
        skills: [{ title: "The Clean-Up Race", desc: "Speed and organization.", steps: ["Set timer for 2 mins", "Pick up 5 red things", "Fastest wins a high-five!"] }],
        stories: [{ title: "The Kind Elephant", text: "An elephant helped a bird... Moral: Kindness makes you a hero." }]
    },
    lounge: {
        bg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', // Deep Purple/Blue
        icebreakers: ["What is a boundary you are currently working on?", "What does 'legacy' mean to you?", "Describe your perfect day of rest."],
        skills: [{ title: "Active Listening", desc: "The art of being present.", steps: ["Repeat back what you heard", "Ask one open-ended question", "Avoid giving advice immediately"] }],
        stories: [{ title: "The Empty Boat", text: "A lesson on internal anger... Moral: Your reactions are your own."]
    },
    carnival: {
        bg: 'linear-gradient(135deg, #F09819 0%, #FF512F 100%)', // Vibrant Orange/Red
        icebreakers: ["Would you rather have cheese for hair or maple syrup for sweat?", "Show us your best dance move!", "What's the weirdest thing you've ever eaten?"],
        skills: [{ title: "The Pen Flip", desc: "Focus and coordination.", steps: ["Try to flip a pen 360 degrees", "Catch it with the same hand", "First to 5 wins!"] }],
        stories: [{ title: "The Laughing King", text: "A king who forgot how to frown... Moral: Joy is a superpower."]
    },
    boardroom: {
        bg: 'linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%)', // Professional Slate/Teal
        icebreakers: ["What is the biggest 'bottleneck' in our current project?", "What is one 'Low Effort, High Impact' win we can grab today?", "If we could automate one task, what should it be?"],
        skills: [{ title: "The 80/20 Analysis", desc: "Maximizing ROI on your time.", steps: ["Identify the 20% of tasks causing 80% of results.", "Identify the 20% of tasks causing 80% of stress.", "Focus on the former, delegate the latter."] }],
        stories: [{ title: "The Sharpened Saw", text: "A woodcutter worked harder but cut less because he wouldn't stop to sharpen his saw. Moral: Strategy and rest are more productive than raw effort." }]
    }
};

const app = {
    currentMode: 'nest',
    state: { completedCards: new Set() },

    setMode: (mode) => {
        app.currentMode = mode;
        const config = LIBRARY[mode];

        // 1. Update UI Buttons
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.classList.remove('active');
            if(btn.id === `btn-${mode}`) btn.classList.add('active');
        });

        // 2. Vibe Check: Change Background
        document.body.style.background = config.bg;

        // 3. Clear Contents
        document.querySelectorAll('.card-content').forEach(c => {
            c.innerHTML = `<p style="opacity:0.5">Vibe changed to ${mode.toUpperCase()}. Generate new content!</p>`;
        });
        
        // 4. Update Header Title
        const titleMapping = { nest: "The Nest", lounge: "The Lounge", carnival: "The Carnival", boardroom: "The Boardroom" };
        document.getElementById('main-title').innerText = `âœ¨ ${titleMapping[mode]}`;
        
        app.state.completedCards.clear();
        app.updateProgress();
    },

    // Standard generator updated to use the new mode logic
    content: {
        icebreaker: () => {
            const list = LIBRARY[app.currentMode].icebreakers;
            const text = list[Math.floor(Math.random() * list.length)];
            document.getElementById('icebreaker-text').innerHTML = `<p class="fade-in"><strong>Focus:</strong> ${text}</p>`;
            app.markComplete('card-icebreaker');
        },
        skill: () => {
            const item = LIBRARY[app.currentMode].skills[0]; // Logic for randomizing can be added
            let stepsHtml = item.steps.map(s => `<li>${s}</li>`).join('');
            document.getElementById('skill-text').innerHTML = `
                <div class="fade-in">
                    <h3>${item.title}</h3>
                    <p>${item.desc}</p>
                    <ul class="skill-steps">${stepsHtml}</ul>
                </div>`;
            app.markComplete('card-skill');
        },
        story: () => {
            const item = LIBRARY[app.currentMode].stories[0];
            document.getElementById('story-text').innerHTML = `<div class="fade-in"><h3>${item.title}</h3><p>${item.text}</p></div>`;
            app.markComplete('card-story');
        }
    }
    // ... rest of the app logic (timer, progress, etc.)
};

 
