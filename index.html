<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The Connection Deck: A tool for meaningful group syncs, team building, and relationship deepening.">
    <title>The Connection Deck</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        :root {
            /* --- MASTER PALETTE --- */
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --glass-surface: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.4);
            --glass-highlight: rgba(255, 255, 255, 0.2);
            --text-main: #1e293b;
            --text-muted: #475569;
            --accent-color: #6366f1;
            --success-color: #10b981;
            --card-radius: 24px;
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        }

        /* --- THEME ENGINE --- */
        body.dark-mode {
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #334155 100%);
            --glass-surface: rgba(30, 41, 59, 0.85);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #f8fafc;
            --text-muted: #cbd5e1;
            --accent-color: #818cf8;
        }

        body.nature-mode { --bg-gradient: linear-gradient(135deg, #134E5E 0%, #71B280 100%); }
        body.warm-mode { --bg-gradient: linear-gradient(135deg, #FF512F 0%, #F09819 100%); }

        /* --- RESET & BASE --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed; /* Parallax effect */
            min-height: 100vh;
            color: var(--text-main);
            padding: 2rem 1rem;
            transition: background 0.8s ease;
        }

        /* --- UTILITIES --- */
        .hidden { display: none !important; }
        .flex-center { display: flex; align-items: center; justify-content: center; }
        
        /* --- LAYOUT --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* --- HEADER & HUD --- */
        header {
            background: var(--glass-surface);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--card-radius);
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow-lg);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-weight: 800;
            font-size: 2.5rem;
            background: linear-gradient(to right, var(--text-main), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .tagline { font-size: 1.1rem; color: var(--text-muted); font-weight: 400; }

        .progress-container {
            margin-top: 1.5rem;
            background: rgba(0,0,0,0.1);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: var(--accent-color);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .top-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        /* --- CARD GRID --- */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        /* --- THE CARD --- */
        .card {
            background: var(--glass-surface);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--card-radius);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s;
            box-shadow: var(--shadow-sm);
            position: relative;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card.completed {
            border-color: var(--success-color);
            border-width: 2px;
        }
        
        .card.completed::after {
            content: "‚úì";
            position: absolute;
            top: 20px;
            right: 20px;
            color: var(--success-color);
            font-weight: bold;
            font-size: 1.5rem;
        }

        .card-icon { font-size: 2.5rem; margin-bottom: 1rem; }
        
        .card h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--text-main);
        }

        .card-content {
            flex-grow: 1;
            margin-bottom: 1.5rem;
            min-height: 80px;
            color: var(--text-muted);
            line-height: 1.6;
            font-size: 1rem;
        }

        /* --- BUTTONS & INPUTS --- */
        .btn {
            background: var(--text-main);
            color: white; /* Inverted for contrast */
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        body.dark-mode .btn { background: var(--accent-color); color: white; }

        .btn:hover { transform: scale(1.02); opacity: 0.95; }
        .btn:active { transform: scale(0.98); }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--text-main);
            color: var(--text-main);
        }

        .btn-outline:hover { background: rgba(0,0,0,0.05); }

        .input-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        input, textarea {
            background: rgba(255,255,255,0.5);
            border: 1px solid rgba(0,0,0,0.1);
            padding: 10px;
            border-radius: 10px;
            font-family: inherit;
            color: var(--text-main);
            width: 100%;
        }

        body.dark-mode input, body.dark-mode textarea {
            background: rgba(0,0,0,0.3);
            border-color: rgba(255,255,255,0.1);
        }

        /* --- SPECIAL MODULES --- */
        .skill-steps {
            background: rgba(0,0,0,0.05);
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
            list-style-position: inside;
        }
        
        .timer-display {
            font-size: 2rem;
            font-weight: 800;
            font-variant-numeric: tabular-nums;
            margin: 10px 0;
            color: var(--accent-color);
        }

        /* --- FOOTER --- */
        footer {
            margin-top: 4rem;
            text-align: center;
            color: rgba(255,255,255,0.8);
            font-size: 0.9rem;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            .card { padding: 1.5rem; }
        }
    </style>
</head>
<body class="light-mode">

    <div class="container">
        
        <header>
            <div class="header-content">
                <h1>The Connection Deck</h1>
                <p class="tagline">Sync up. Go deeper. Grow together.</p>
                
                <div class="progress-container">
                    <div class="progress-bar" id="meetingProgress"></div>
                </div>

                <div class="top-controls">
                    <button class="btn btn-outline" onclick="themeManager.toggle()">üé® Theme</button>
                    <button class="btn btn-outline" onclick="app.showModal('rules')">üìú Covenant</button>
                    <button class="btn btn-outline" onclick="location.reload()">üîÑ Reset Deck</button>
                </div>
            </div>
        </header>

        <main class="grid">

            <article class="card" id="card-checkin">
                <div class="card-icon">üëã</div>
                <h2>The Check-In</h2>
                <div class="card-content">
                    <p>Start by clearing the air. Share briefly:</p>
                    <ul style="margin: 10px 0 15px 20px;">
                        <li><strong>üîã Battery Level:</strong> (0-100%)</li>
                        <li><strong>üèÜ A Win:</strong> Something that went well.</li>
                        <li><strong>‚öì An Anchor:</strong> Something weighing on you.</li>
                    </ul>
                    <div class="input-group">
                        <input type="number" id="pCount" placeholder="# People" style="width: 80px; text-align: center;">
                        <button class="btn" onclick="app.generateOrder()">üé≤ Who Goes First?</button>
                    </div>
                    <div id="orderResult" style="margin-top: 15px; font-weight: 700; color: var(--accent-color);"></div>
                </div>
            </article>

            <article class="card" id="card-icebreaker">
                <div class="card-icon">üßä</div>
                <h2>Deep Breaker</h2>
                <div class="card-content" id="icebreaker-text">
                    <p>Move past small talk. Click to generate a question that matters.</p>
                </div>
                <button class="btn" onclick="app.content.icebreaker()">üî• Ignite Conversation</button>
            </article>

            <article class="card" id="card-quote">
                <div class="card-icon">üß†</div>
                <h2>Perspective Shift</h2>
                <div class="card-content" id="quote-text">
                    <p>A thought to anchor the meeting.</p>
                </div>
                <button class="btn" onclick="app.content.quote()">‚ú® Reveal Wisdom</button>
            </article>

            <article class="card" id="card-skill">
                <div class="card-icon">üõ†Ô∏è</div>
                <h2>Micro-Workshop</h2>
                <div class="card-content" id="skill-text">
                    <p>Don't just talk. <strong>Do.</strong> Generate a quick activity to build a better life skill together.</p>
                </div>
                <button class="btn" onclick="app.content.skill()">üöÄ Start Activity</button>
            </article>

            <article class="card" id="card-story">
                <div class="card-icon">üìö</div>
                <h2>The Parable</h2>
                <div class="card-content" id="story-text">
                    <p>A story to discuss values without lecturing.</p>
                </div>
                <button class="btn" onclick="app.content.story()">üìñ Read Story</button>
            </article>

            <article class="card" id="card-timer">
                <div class="card-icon">‚è≥</div>
                <h2>The Soapbox</h2>
                <div class="card-content">
                    <p>Need to vent or explain something complex? Use the timer to ensure equity.</p>
                    <div class="timer-display" id="timerDisplay">02:00</div>
                </div>
                <div class="input-group" style="justify-content: center;">
                    <button class="btn" onclick="app.timer.start()">‚ñ∂ Start</button>
                    <button class="btn btn-outline" onclick="app.timer.reset()">‚èπ Reset</button>
                </div>
            </article>

            <article class="card" style="grid-column: 1 / -1;" id="card-notes">
                <div class="card-icon">üìù</div>
                <h2>The Action Plan</h2>
                <div class="card-content">
                    <p>Meetings without action are just dreams. What are we doing differently this week?</p>
                    <textarea id="meetingNotes" rows="5" placeholder="- Who is doing what?&#10;- When is it due?&#10;- What did we decide?"></textarea>
                </div>
                <button class="btn" onclick="app.exportNotes()">üì• Save Protocol</button>
            </article>

        </main>

        <footer>
            <p>Built with intention by <strong>Max</strong>. The Connection Deck v2.0</p>
        </footer>

    </div>

    <script>
        // --- CONTENT LIBRARY (No APIs, Guaranteed Reliability) ---
        const LIBRARY = {
            icebreakers: [
                "What is a 'hard truth' you learned recently?",
                "If you could have a 1-hour dinner with anyone (living or dead), who and why?",
                "What is one behavior you are trying to unlearn?",
                "What does 'success' look like to you in this specific chapter of your life?",
                "If money was no object, how would you spend your days?",
                "What is a compliment you wish you received more often?",
                "When do you feel most like yourself?",
                "What is a boundary you need to set this week to protect your peace?",
                "If our group was a band, what would we be called and who plays what?",
                "What is one thing you are grateful for about the person to your left?"
            ],
            quotes: [
                { text: "We interpret the world not as it is, but as we are.", author: "Ana√Øs Nin" },
                { text: "Do not spoil what you have by desiring what you have not.", author: "Epicurus" },
                { text: "Vulnerability is the birthplace of innovation, creativity, and change.", author: "Bren√© Brown" },
                { text: "The problem with the world is that the intelligent people are full of doubts, while the stupid ones are full of confidence.", author: "Charles Bukowski" },
                { text: "Peace is the result of retraining your mind to process life as it is, rather than as you think it should be.", author: "Wayne Dyer" }
            ],
            skills: [
                {
                    title: "The Box Breathing Technique",
                    desc: "A Navy SEAL tactic to hack your nervous system and reduce stress instantly.",
                    steps: ["Inhale for 4 seconds.", "Hold lungs full for 4 seconds.", "Exhale for 4 seconds.", "Hold lungs empty for 4 seconds. Repeat 4 times."]
                },
                {
                    title: "The Eisenhower Matrix",
                    desc: "Stop being 'busy' and start being effective. Draw a 2x2 grid.",
                    steps: ["Q1: Urgent & Important (Do it now).", "Q2: Not Urgent but Important (Schedule it - this is where growth happens).", "Q3: Urgent but Not Important (Delegate it).", "Q4: Neither (Delete it)."]
                },
                {
                    title: "Active Listening: The Mirror",
                    desc: "Most people listen to reply, not to understand. Try this.",
                    steps: ["Pair up.", "Person A speaks for 60 seconds.", "Person B cannot interrupt.", "Person B must say: 'What I heard you say was...' and repeat it back.", "Switch."]
                },
                {
                    title: "The 2-Minute Rule",
                    desc: "Stop procrastination instantly.",
                    steps: ["Look at your to-do list.", "Is there anything that takes less than 2 minutes?", "Do it immediately. Do not write it down.", "This creates momentum for bigger tasks."]
                },
                {
                    title: "Gratitude Ping Pong",
                    desc: "Rewire your brain to scan for the positive.",
                    steps: ["Go around the circle rapidly.", "Say one distinct thing you are grateful for.", "No repeats.", "Keep the volley going for 60 seconds without dropping the ball."]
                }
            ],
            stories: [
                { 
                    title: "The Starfish Thrower", 
                    text: "An old man walked the beach at dawn, seeing thousands of starfish washed ashore. He saw a young boy throwing them back one by one. 'Son,' the man said, 'there are miles of beach and thousands of starfish. You can't make a difference.' The boy picked up another, threw it into the ocean, and smiled. 'I made a difference to that one.'" 
                },
                {
                    title: "The Two Wolves",
                    text: "An old Cherokee told his grandson: 'My son, there is a battle between two wolves inside us all. One is Evil (anger, jealousy, greed, ego). The other is Good (joy, peace, love, humility).' The boy asked, 'Which wolf wins?' The grandfather replied, 'The one you feed.'"
                },
                {
                    title: "The Empty Boat",
                    text: "A monk was meditating in a boat. He felt another boat hit his. Anger rose in him. He opened his eyes to scream at the careless boatman, but saw the boat was empty; it had just drifted downstream. His anger vanished. The monk realized: the anger was never about the boatman, it was inside him all along."
                }
            ]
        };

        // --- APP CONTROLLER ---
        const app = {
            state: {
                progress: 0,
                completedCards: new Set()
            },

            init: () => {
                themeManager.init();
            },

            markComplete: (cardId) => {
                const card = document.getElementById(cardId);
                if (!app.state.completedCards.has(cardId)) {
                    app.state.completedCards.add(cardId);
                    card.classList.add('completed');
                    app.updateProgress();
                }
            },

            updateProgress: () => {
                const totalCards = 6; // Excluding optional ones
                const current = app.state.completedCards.size;
                const percentage = Math.min((current / totalCards) * 100, 100);
                document.getElementById('meetingProgress').style.width = `${percentage}%`;
            },

            generateOrder: () => {
                const count = document.getElementById('pCount').value;
                const resultDiv = document.getElementById('orderResult');
                if (!count || count < 2) {
                    resultDiv.innerText = "Please enter at least 2 people.";
                    return;
                }
                let arr = Array.from({length: count}, (_, i) => i + 1);
                arr.sort(() => Math.random() - 0.5);
                resultDiv.innerHTML = `Order: Player ${arr.join(" ‚û° Player ")}`;
                app.markComplete('card-checkin');
            },

            content: {
                icebreaker: () => {
                    const text = LIBRARY.icebreakers[Math.floor(Math.random() * LIBRARY.icebreakers.length)];
                    document.getElementById('icebreaker-text').innerHTML = `<p class="fade-in"><strong>Question:</strong> ${text}</p>`;
                    app.markComplete('card-icebreaker');
                },
                quote: () => {
                    const item = LIBRARY.quotes[Math.floor(Math.random() * LIBRARY.quotes.length)];
                    document.getElementById('quote-text').innerHTML = `<blockquote class="fade-in">"${item.text}"<br>‚Äî <small>${item.author}</small></blockquote>`;
                    app.markComplete('card-quote');
                },
                skill: () => {
                    const item = LIBRARY.skills[Math.floor(Math.random() * LIBRARY.skills.length)];
                    let stepsHtml = item.steps.map(s => `<li>${s}</li>`).join('');
                    document.getElementById('skill-text').innerHTML = `
                        <div class="fade-in">
                            <h3>${item.title}</h3>
                            <p>${item.desc}</p>
                            <ul class="skill-steps">${stepsHtml}</ul>
                        </div>`;
                    app.markComplete('card-skill');
                },
                story: () => {
                    const item = LIBRARY.stories[Math.floor(Math.random() * LIBRARY.stories.length)];
                    document.getElementById('story-text').innerHTML = `<div class="fade-in"><h3>${item.title}</h3><p>${item.text}</p></div>`;
                    app.markComplete('card-story');
                }
            },

            timer: {
                interval: null,
                timeLeft: 120, // seconds
                start: () => {
                    if (app.timer.interval) return;
                    app.timer.interval = setInterval(() => {
                        app.timer.timeLeft--;
                        const m = Math.floor(app.timer.timeLeft / 60).toString().padStart(2, '0');
                        const s = (app.timer.timeLeft % 60).toString().padStart(2, '0');
                        document.getElementById('timerDisplay').innerText = `${m}:${s}`;
                        
                        if (app.timer.timeLeft <= 0) {
                            clearInterval(app.timer.interval);
                            document.getElementById('timerDisplay').innerText = "TIME'S UP!";
                            document.getElementById('timerDisplay').style.color = "red";
                            app.markComplete('card-timer');
                        }
                    }, 1000);
                },
                reset: () => {
                    clearInterval(app.timer.interval);
                    app.timer.interval = null;
                    app.timer.timeLeft = 120;
                    document.getElementById('timerDisplay').innerText = "02:00";
                    document.getElementById('timerDisplay').style.color = "var(--accent-color)";
                }
            },

            exportNotes: () => {
                const notes = document.getElementById('meetingNotes').value;
                if(!notes) return alert("Write something first!");
                
                const blob = new Blob([`CONNECTION DECK SESSION\nDate: ${new Date().toLocaleDateString()}\n\nACTION ITEMS:\n${notes}`], { type: "text/plain" });
                const a = document.createElement("a");
                a.href = URL.createObjectURL(blob);
                a.download = `Session-Notes-${new Date().toISOString().slice(0,10)}.txt`;
                a.click();
                app.markComplete('card-notes');
            },
            
            showModal: (type) => {
                if(type === 'rules') alert("THE COVENANT:\n1. Mobile devices down.\n2. Listen to understand, not to reply.\n3. What is said here, stays here.\n4. Participate with 100% intention.");
            }
        };

        // --- THEME MANAGER ---
        const themeManager = {
            themes: ['', 'dark-mode', 'nature-mode', 'warm-mode'],
            current: 0,
            init: () => {
                // Check local storage if you want persistence later
            },
            toggle: () => {
                themeManager.current = (themeManager.current + 1) % themeManager.themes.length;
                document.body.className = themeManager.themes[themeManager.current];
            }
        };

        // Initialize
        app.init();

    </script>
</body>
</html>
