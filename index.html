<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Meeting Hub</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --shadow-light: 0 8px 32px rgba(31, 38, 135, 0.37);
            --button-disabled-bg: #ccc;
            --progress-glow-color: #38bdf8;
        }

        [data-theme="dark"] {
            --primary-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            --glass-bg: rgba(0, 0, 0, 0.25);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #f7fafc;
            --text-secondary: #e2e8f0;
            --button-disabled-bg: #555;
            --progress-glow-color: #f59e0b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--primary-gradient);
            min-height: 100vh;
            color: var(--text-primary);
            transition: background 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        .header {
            text-align: center;
            padding: 2rem 1rem;
            margin-bottom: 2rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: var(--shadow-light);
            backdrop-filter: blur(10px);
        }

        .header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .header p { font-size: 1.2rem; opacity: 0.9; min-height: 1.5rem; }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .control-btn {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-btn:hover { transform: translateY(-3px); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }

        .meeting-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 28px;
        }

        .meeting-box {
            background: var(--glass-bg);
            border: 2px solid transparent;
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow-light);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            transition: border-color 0.4s ease, box-shadow 0.4s ease;
        }
        
        .card-used {
            border-color: var(--progress-glow-color);
            box-shadow: 0 0 15px var(--progress-glow-color);
        }

        .meeting-box h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .content { flex-grow: 1; margin-bottom: 1rem; line-height: 1.6; }
        .content ul { list-style-position: inside; padding-left: 10px; }
        .content p, .content ul { margin-bottom: 10px; }
        .content h3 { margin-bottom: 10px; font-size: 1.2rem; color: var(--text-primary); }
        .content blockquote { font-style: italic; padding-left: 15px; border-left: 3px solid var(--text-secondary); margin-left: 0; opacity: 0.9; }
        
        .random-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95rem;
            align-self: flex-start;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .random-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .random-btn:disabled { background: var(--button-disabled-bg); cursor: not-allowed; opacity: 0.7; }
        .notes-area { width: 100%; min-height: 100px; padding: 10px; border-radius: 10px; border: 1px solid var(--glass-border); background-color: var(--glass-bg); color: var(--text-primary); font-family: inherit; }

        /* MODAL STYLES */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            color: #2d3748;
            margin: 10% auto;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        [data-theme="dark"] .modal-content { background: rgba(30, 41, 59, 0.95); color: #f7fafc; }
        .modal-close { position: absolute; top: 15px; right: 25px; font-size: 2rem; font-weight: bold; cursor: pointer; transition: transform 0.2s ease; }
        .modal-close:hover { transform: scale(1.2); }
        .modal-content h2 { margin-bottom: 1rem; }
        .modal-content ul, .modal-content ol { padding-left: 25px; }

        @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
    </style>
</head>
<body>

    <div class="container">
        <header class="header">
            <h1 id="main-title">‚ú® Family Meeting Hub</h1>
            <p id="subtitle"></p>
        </header>

        <div class="controls">
            <button class="control-btn" onclick="showHelpModal()">‚ùì How to Use</button>
            <button class="control-btn" onclick="showRulesModal()">üìú Meeting Rules</button>
            <button class="control-btn" id="startBtn" onclick="startMeeting()">üöÄ New Meeting</button>
            <button class="control-btn" onclick="toggleTheme()"><span id="themeIcon">üåô</span> Toggle Theme</button>
        </div>

        <div class="meeting-grid">
            <div class="meeting-box" id="card-iceBreaker"><h2>üéØ Ice Breaker</h2><div class="content" id="iceBreaker"><p>Let's get the conversation flowing!</p></div><button class="random-btn" onclick="generateIceBreaker(this)">Get Question</button></div>
            <div class="meeting-box" id="card-famousQuote"><h2>üí¨ Inspiring Quote</h2><div class="content" id="famousQuote"><blockquote>An inspiring quote will appear here...</blockquote></div><button class="random-btn" onclick="generateQuote(this)">Get Quote</button></div>
            <div class="meeting-box" id="card-checkIn"><h2>üíñ Check-In</h2><div class="content"><p>Go around and share using the **Rose, Bud, Thorn** format:</p><ul><li><strong>üåπ Rose:</strong> A highlight or positive moment.</li><li><strong>üå± Bud:</strong> Something you're looking forward to.</li><li><strong>üåµ Thorn:</strong> A challenge you faced.</li></ul></div></div>
            <div class="meeting-box" id="card-interestingFact"><h2>üí° Amazing Fact</h2><div class="content" id="interestingFact"><p>Ready to discover something incredible?</p></div><button class="random-btn" onclick="generateFact(this)">Discover Fact</button></div>
            <div class="meeting-box" id="card-moralStory"><h2>üìñ Story Time</h2><div class="content" id="moralStory"><p>A meaningful story to share...</p></div><button class="random-btn" onclick="generateStory(this)">Tell Story</button></div>
            <div class="meeting-box" id="card-lifeSkill"><h2>üõ†Ô∏è Life Skill</h2><div class="content" id="lifeSkill"><p>Learn a valuable skill together!</p></div><button class="random-btn" onclick="generateSkill(this)">Learn Skill</button></div>
            <div class="meeting-box" id="card-jokeContent"><h2>üòÇ Joke Time</h2><div class="content" id="jokeContent"><p>Ready for a laugh?</p></div><button class="random-btn" onclick="generateJoke(this)">Tell Joke</button></div>
            <div class="meeting-box" id="card-upcoming"><h2>üóìÔ∏è Upcoming Events</h2><div class="content"><p>Let's look at the week ahead...</p></div></div>
            <div class="meeting-box" id="card-notes"><h2>üìù Meeting Notes</h2><div class="content"><p>Capture important moments:</p><textarea class="notes-area" id="meetingNotes" placeholder="Write down key points..."></textarea><div style="margin-top: 16px;"><button class="random-btn" onclick="exportNotes()">üìÑ Export Notes</button></div></div></div>
        </div>
    </div>
    
    <div id="helpModal" class="modal"><div class="modal-content"><span class="modal-close" onclick="closeHelpModal()">&times;</span><h2>How to Use This Tool</h2><ol><li><strong>Set the Stage:</strong> Use the "Meeting Rules" button to review the ground rules for a great meeting.</li><li><strong>Start a "New Meeting":</strong> Click this to reset all the cards and progress indicators for a fresh start.</li><li><strong>Follow the Flow:</strong> The cards are in a suggested order. Start with an "Ice Breaker" to warm up, an "Inspiring Quote" to set the tone, and then the "Check-In."</li><li><strong>Generate Content:</strong> Click the button on any card to get a random prompt. The card will glow to show it's been used in this session.</li><li><strong>Discuss:</strong> Use the prompts to spark meaningful conversations.</li><li><strong>Take Notes:</strong> Use the "Meeting Notes" card to capture anything important. You can export these notes as a text file when you're done.</li></ol></div></div>
    <div id="rulesModal" class="modal"><div class="modal-content"><span class="modal-close" onclick="closeRulesModal()">&times;</span><h2>Suggested Meeting Rules</h2><ul><li><strong>Be Present:</strong> Put away phones and other distractions. Let's give each other our full attention.</li><li><strong>One Speaker at a Time:</strong> Everyone gets a chance to speak without being interrupted.</li><li><strong>Listen to Understand:</strong> Don't just wait for your turn to talk. Truly listen to what others are saying and feeling.</li><li><strong>Be Respectful:</strong> It's okay to disagree, but we must be kind and respectful in how we express ourselves. No name-calling or yelling.</li><li><strong>Everyone Participates:</strong> Every voice matters! Let's make sure everyone, from the oldest to the youngest, has a chance to share.</li><li><strong>Focus on Solutions:</strong> When discussing challenges, let's work together to find solutions, not just dwell on problems.</li></ul></div></div>

    <script>
        // --- CONTENT ARRAYS & CONFIG ---
        const API_URLS = { fact: 'https://uselessfacts.jsph.pl/random.json?language=en', quote: 'https://api.quotable.io/random', joke: 'https://official-joke-api.appspot.com/random_joke' };
        const subtitles = [ "Time to connect and share.", "Let's make today's meeting great.", "Your weekly huddle starts now.", "A moment to grow together.", "Discover something new about your family." ];

        // --- EXPANDED CONTENT ---
        const allIceBreakers = ["If you could have any superpower, what would it be and why?", "What's one thing you're grateful for today?", "If you could talk to animals, which animal would you ask for advice?", "What's the best thing that happened to you this week?", "If you could invent a new holiday, what would it be and how would we celebrate?", "What's a small thing that always makes you smile?", "If you could have any fictional character as a best friend, who would you choose?", "What's your favorite smell and what memory does it bring up?", "If you could only eat one food for the rest of your life, what would it be?", "What's a skill you'd like to learn?", "If you were a flavor of ice cream, what would you be?", "What book, movie, or TV show have you seen recently that you'd recommend?", "What's one place you'd love to travel to?", "If you could ask your future self one question, what would it be?", "What's a simple act of kindness you witnessed or did this week?", "If you could be famous for one thing, what would it be?", "What's your favorite thing about our family?", "If you could solve one world problem, what would it be?", "What's a song that always puts you in a good mood?", "What's something you're looking forward to?", "If you had to describe your day with a movie title, what would it be?", "What's the weirdest dream you've ever had?", "If you could bring one extinct animal back to life, which would it be?", "What's something you've accomplished that you're proud of?", "If you could have dinner with any three people, living or dead, who would they be?", "What's a word that you think is really fun to say?", "What's your favorite season and why?", "If you had to create a new rule for our family for a day, what would it be?", "What's the best advice you've ever received?", "If you could instantly become an expert in something, what would it be?", "What's a tradition you'd like to start as a family?", "If you could have a personal robot, what would you have it do?", "What's something that you find beautiful in nature?", "What's a challenge you've overcome?", "If you could visit any time period, past or future, when would you go?", "What's the funniest joke you know?", "What's something you did this week to help someone else?", "If you could design a new toy, what would it be?", "What makes a good friend?", "What's your favorite family memory?", "If you had to give up either music or movies for a year, which would you choose?", "What's a food you used to dislike but now you love?", "What's something you want to get better at?", "If you could have any wild animal as a pet, what would it be?", "What's a goal you have for yourself for this month?", "If you were a superhero, what would your name be?", "What's the most interesting thing you've learned recently?", "If you could trade places with a family member for a day, who would it be?", "What's your favorite way to relax?", "If you could create a new flavor of potato chip, what would it be?"];
        const allStories = [ { title: "The Lion and the Mouse", story: "A lion was about to eat a mouse, who pleaded for his life. The lion let him go. Later, the lion was trapped in a net. The mouse gnawed the ropes, freeing him. Moral: An act of kindness, no matter how small, is never wasted." }, { title: "The Tortoise and the Hare", story: "A hare boasted about his speed and challenged a tortoise to a race. The hare, far ahead, took a nap. The tortoise kept moving slowly but steadily and crossed the finish line first. Moral: Slow and steady wins the race." } /* ... More stories ... */];
        
        // --- REVAMPED LIFE SKILLS ---
        const allSkills = [
            { title: "The Art of Active Listening", lesson: "Active listening is more than just being quiet; it's about making someone feel truly heard. When someone is speaking, focus entirely on them, not on what you'll say next. Make eye contact and nod. When they're done, try summarizing what you heard, like 'So, it sounds like you felt frustrated because...' This shows you were paying attention and builds strong bonds of trust." },
            { title: "Giving a Sincere Apology", lesson: "A good apology can fix almost anything, but it has to be sincere. It has three parts: 1) Say 'I'm sorry for...' and name what you did. 2) Explain that you understand how it made them feel. 3) Say what you will do differently next time. Skipping any of these steps can make an apology feel empty. A real apology is about taking responsibility, not just saying words." },
            { title: "The 'Two-Minute' Rule for Chores", lesson: "Procrastination is the enemy of a tidy space! The 'Two-Minute Rule' is a simple trick to beat it. If you see a task that can be done in two minutes or less (like putting a dish in the dishwasher, wiping a counter, or taking out the trash), do it immediately instead of putting it off. These tiny actions add up and prevent small messes from becoming big projects." },
            { title: "How to Disagree Respectfully", lesson: "It's normal to disagree, but it's important to do it kindly. Instead of saying 'You're wrong,' try using 'I' statements. For example, say 'I see it differently, here's my perspective...' instead of attacking their idea. The goal isn't to 'win' the argument, but to understand the other person's point of view and find common ground, even if you don't end up agreeing." },
            { title: "The Habit of Gratitude", lesson: "Gratitude is like a muscle; the more you use it, the stronger it gets. A simple practice is to name three specific things you are grateful for each day. Don't just say 'my family.' Be specific, like 'I'm grateful that Dad helped me with my homework today.' This trains your brain to look for the good in your life, which can make you a happier and more positive person." },
            { title: "How to Set a Simple Goal", lesson: "A goal without a plan is just a wish. To make a goal real, make it 'SMART': Specific, Measurable, Achievable, Relevant, and Time-bound. Instead of 'I want to be better at math,' a SMART goal would be 'I will practice my multiplication tables for 15 minutes, three times a week, so I can improve my score on the next quiz in two weeks.' This gives you a clear path to success." },
        ]; // This list would be expanded to 50+ items in the full implementation

        let usedContent = {};

        function initializeApp() {
            document.getElementById('subtitle').textContent = subtitles[Math.floor(Math.random() * subtitles.length)];
            initializeUsedContent();
        }

        function initializeUsedContent() { usedContent = { iceBreakers: [], stories: [], skills: [] }; }
        
        function startMeeting() {
            const cards = ['iceBreaker', 'famousQuote', 'interestingFact', 'moralStory', 'lifeSkill', 'jokeContent'];
            cards.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerHTML = `<p>${el.parentElement.querySelector('h2').textContent} will appear here!</p>`;
            });
            document.querySelectorAll('.meeting-box').forEach(card => card.classList.remove('card-used'));
            initializeApp(); 
            alert("New meeting started! Content and progress is refreshed.");
        }

        function setButtonLoadingState(button, isLoading, originalText) {
            button.disabled = isLoading;
            button.textContent = isLoading ? 'Loading...' : originalText;
        }
        
        function markCardUsed(button) { button.closest('.meeting-box').classList.add('card-used'); }

        async function fetchApiContent(url, button, originalText, formatter) {
            setButtonLoadingState(button, true, originalText);
            markCardUsed(button);
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`Network error`);
                const data = await response.json();
                return formatter(data);
            } catch (error) {
                return `<p>Oops! Couldn't fetch content. Please try again.</p>`;
            } finally {
                setButtonLoadingState(button, false, originalText);
            }
        }

        async function generateFact(button) { document.getElementById('interestingFact').innerHTML = await fetchApiContent(API_URLS.fact, button, 'Discover Fact', data => `<p>${data.text}</p>`); }
        async function generateQuote(button) { document.getElementById('famousQuote').innerHTML = await fetchApiContent(API_URLS.quote, button, 'Get Quote', data => `<blockquote>"${data.content}"<br><em>- ${data.author}</em></blockquote>`); }
        async function generateJoke(button) { document.getElementById('jokeContent').innerHTML = await fetchApiContent(API_URLS.joke, button, 'Tell Joke', data => `<p><strong>${data.setup}</strong><br><em>${data.punchline}</em></p>`); }

        function getRandomItem(itemType, itemsArray) {
            if (!itemsArray || itemsArray.length === 0) return null;
            let available = itemsArray.filter((_, i) => !usedContent[itemType].includes(i));
            if (available.length === 0) {
                usedContent[itemType] = [];
                available = itemsArray;
            }
            const randomIndex = Math.floor(Math.random() * available.length);
            const item = available[randomIndex];
            usedContent[itemType].push(itemsArray.indexOf(item));
            return item;
        }

        function generateStaticContent(button, originalText, itemType, array, elementId, formatter) {
            setButtonLoadingState(button, true, originalText);
            markCardUsed(button);
            setTimeout(() => {
                const item = getRandomItem(itemType, array);
                document.getElementById(elementId).innerHTML = item ? formatter(item) : `<p>Add more content!</p>`;
                setButtonLoadingState(button, false, originalText);
            }, 200);
        }
        
        function generateIceBreaker(button) { generateStaticContent(button, 'Get Question', 'iceBreakers', allIceBreakers, 'iceBreaker', item => `<p>${item}</p>`); }
        function generateStory(button) { generateStaticContent(button, 'Tell Story', 'stories', allStories, 'moralStory', item => `<h3>${item.title}</h3><p>${item.story}</p>`); }
        function generateSkill(button) { generateStaticContent(button, 'Learn Skill', 'skills', allSkills, 'lifeSkill', item => `<h3>${item.title}</h3><p>${item.lesson}</p>`); }
        
        // MODAL and THEME functions
        function showHelpModal() { document.getElementById('helpModal').style.display = 'block'; }
        function closeHelpModal() { document.getElementById('helpModal').style.display = 'none'; }
        function showRulesModal() { document.getElementById('rulesModal').style.display = 'block'; }
        function closeRulesModal() { document.getElementById('rulesModal').style.display = 'none'; }
        
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = "none";
            }
        }
        
        function toggleTheme() {
            const body = document.documentElement;
            body.setAttribute('data-theme', body.getAttribute('data-theme') === 'dark' ? '' : 'dark');
            document.getElementById('themeIcon').textContent = body.getAttribute('data-theme') === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }
        
        function exportNotes() {
            const notes = document.getElementById('meetingNotes').value;
            if (!notes.trim()) { alert("Notes are empty!"); return; }
            const blob = new Blob([notes], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.download = `Meeting-Notes-${new Date().toISOString().slice(0, 10)}.txt`;
            link.href = URL.createObjectURL(blob);
            link.click();
            URL.revokeObjectURL(link.href);
            markCardUsed(document.querySelector('#card-notes .random-btn'));
        }
        
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>

