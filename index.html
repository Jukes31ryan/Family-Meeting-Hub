<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Deck</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* GLOBAL ANIMATIONS */
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* --- THEME: FAMILY (Cozy, Warm, Modern) --- */
        body[data-mode="family"] {
            --bg: #FFF8F0; /* Soft Almond */
            --surface: #FFFFFF;
            --text-main: #4A403A;
            --text-sub: #8C8179;
            --accent: #FF7E5F; /* Coral */
            --accent-glow: rgba(255, 126, 95, 0.3);
            --border: #F0E6DD;
        }

        /* --- THEME: FRIENDS (Night Mode, Electric) --- */
        body[data-mode="friends"] {
            --bg: #0F172A; /* Deep Navy */
            --surface: #1E293B;
            --text-main: #F8FAFC;
            --text-sub: #94A3B8;
            --accent: #C084FC; /* Neon Purple */
            --accent-glow: rgba(192, 132, 252, 0.3);
            --border: #334155;
        }

        /* --- THEME: WORK (Clean, Professional, Trust) --- */
        body[data-mode="work"] {
            --bg: #F1F5F9; /* Cool Gray */
            --surface: #FFFFFF;
            --text-main: #0F172A;
            --text-sub: #64748B;
            --accent: #0284C7; /* Professional Blue */
            --accent-glow: rgba(2, 132, 199, 0.2);
            --border: #E2E8F0;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            min-height: 100vh;
            padding: 40px 20px;
            transition: var(--transition);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        /* --- HEADER & TABS --- */
        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-weight: 800;
            font-size: 3rem;
            margin-bottom: 10px;
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-sub);
            margin-bottom: 30px;
        }

        /* The Pill Switcher */
        .mode-tabs {
            background: var(--surface);
            border: 1px solid var(--border);
            display: inline-flex;
            padding: 6px;
            border-radius: 50px;
            box-shadow: 0 4px 20px -5px rgba(0,0,0,0.05);
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 10px 24px;
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Outfit', sans-serif;
            font-weight: 600;
            color: var(--text-sub);
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .tab-btn.active {
            background: var(--accent);
            color: white;
            box-shadow: 0 4px 15px var(--accent-glow);
        }

        /* --- GRID --- */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
        }

        /* --- CARDS (The "Premium" Look) --- */
        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 30px;
            position: relative;
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.05);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.1);
            border-color: var(--accent);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .tag {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 800;
            color: var(--accent);
            background: var(--accent-glow);
            padding: 6px 12px;
            border-radius: 8px;
        }

        .card-content {
            flex-grow: 1;
            margin-bottom: 25px;
            font-size: 1.15rem;
            line-height: 1.6;
            color: var(--text-main);
            min-height: 80px;
            display: flex;
            align-items: center;
        }

        /* Specific Content Styling */
        .card-content p { width: 100%; }
        .card-content h3 { color: var(--accent); margin-bottom: 8px; font-size: 1.2rem; }
        .card-content blockquote {
            border-left: 4px solid var(--accent);
            padding-left: 16px;
            font-style: italic;
            color: var(--text-sub);
        }

        /* --- ACTION BUTTONS --- */
        .btn {
            background: var(--surface);
            border: 2px solid var(--border);
            color: var(--text-main);
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            font-weight: 700;
            font-family: 'Outfit', sans-serif;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: var(--accent-glow);
        }

        .btn:active { transform: scale(0.98); }

        /* --- NOTES AREA --- */
        textarea {
            width: 100%;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            color: var(--text-main);
            font-family: 'Outfit', sans-serif;
            font-size: 1rem;
            resize: vertical;
            min-height: 120px;
            transition: var(--transition);
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--accent);
            background: var(--surface);
            box-shadow: 0 0 0 4px var(--accent-glow);
        }

        /* --- LISTS --- */
        .check-list { list-style: none; }
        .check-list li {
            padding: 10px;
            background: var(--bg);
            margin-bottom: 8px;
            border-radius: 8px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* --- FOOTER CONTROLS --- */
        .footer-controls {
            margin-top: 40px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .footer-btn {
            background: transparent;
            border: none;
            color: var(--text-sub);
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .footer-btn:hover { color: var(--accent); text-decoration: underline; }

        /* Toast */
        #toast {
            visibility: hidden; min-width: 250px; background-color: var(--text-main); color: var(--bg);
            text-align: center; border-radius: 50px; padding: 16px; position: fixed;
            z-index: 100; left: 50%; bottom: 30px; transform: translateX(-50%);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); font-weight: 600;
        }
        #toast.show { visibility: visible; bottom: 50px; transition: 0.3s; }

        @media (max-width: 700px) {
            h1 { font-size: 2rem; }
            .mode-tabs { width: 100%; display: flex; }
            .tab-btn { flex: 1; padding: 10px 0; }
        }
    </style>
</head>
<body data-mode="family">

    <div class="container">
        <header>
            <h1 id="app-title">Family Deck</h1>
            <p class="subtitle">Meaningful conversations, made simple.</p>
            
            <div class="mode-tabs">
                <button class="tab-btn active" onclick="setMode('family')" id="tab-family">Family</button>
                <button class="tab-btn" onclick="setMode('friends')" id="tab-friends">Friends</button>
                <button class="tab-btn" onclick="setMode('work')" id="tab-work">Work</button>
            </div>
        </header>

        <div class="grid">
            
            <div class="card">
                <div class="card-header"><span class="tag" id="tag-1">Warm Up</span></div>
                <div class="card-content" id="content-iceBreaker">
                    <p>Click below to start...</p>
                </div>
                <button class="btn" onclick="generate('iceBreaker')" id="btn-1">Draw Card</button>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag" id="tag-2">Check In</span></div>
                <div class="card-content" style="display:block;">
                    <ul class="check-list" id="list-checkin">
                        </ul>
                </div>
                <div style="display: flex; gap: 10px;">
                    <input type="number" id="participantCount" placeholder="#" style="width: 60px; text-align: center; border: 1px solid var(--border); border-radius: 8px;">
                    <button class="btn" onclick="generateOrder()">Pick Order</button>
                </div>
                <div id="checkInOrder" style="margin-top: 10px; font-weight: bold; color: var(--accent); font-size: 0.9rem;"></div>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag" id="tag-3">Deep Dive</span></div>
                <div class="card-content" id="content-dynamic">
                    <p>Ready for the main event?</p>
                </div>
                <button class="btn" onclick="generate('dynamic')" id="btn-3">Next</button>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag" id="tag-4">Learn</span></div>
                <div class="card-content" id="content-skill">
                    <p>Learn something new.</p>
                </div>
                <button class="btn" onclick="generate('skill')" id="btn-4">Teach Me</button>
            </div>

            <div class="card">
                <div class="card-header"><span class="tag">Humor</span></div>
                <div class="card-content" id="content-joke">
                    <p>Need a laugh?</p>
                </div>
                <button class="btn" onclick="generateJoke()">Tell Joke</button>
            </div>

            <div class="card" style="grid-column: 1 / -1;">
                <div class="card-header"><span class="tag">Notes</span></div>
                <textarea id="notes" placeholder="Capture key moments here... (Auto-saved)"></textarea>
                <div style="margin-top: 15px; text-align: center;">
                    <button class="btn" style="width: auto; display: inline-flex;" onclick="copyNotes()">Copy to Clipboard</button>
                </div>
            </div>

        </div>

        <div class="footer-controls">
            <button class="footer-btn" onclick="alert('Rules: 1. No Phones. 2. Listen. 3. Have Fun.')">View Rules</button>
            <button class="footer-btn" onclick="if(confirm('Clear all data?')) { localStorage.clear(); location.reload(); }">Reset App</button>
        </div>
    </div>

    <div id="toast">Copied!</div>

<script>
    // --- 1. THE MASSIVE DATABASE (INCREASED!) ---
    
    const db = {
        family: {
            title: "Family Deck",
            subtitle: "Meaningful conversations, made simple.",
            tags: ["Ice Breaker", "Rose, Bud, Thorn", "Story Time", "Life Skill"],
            btns: ["Get Question", "Read Story", "Learn Skill"],
            checkin: [
                "üåπ <strong>Rose:</strong> Best part of your week.",
                "üåµ <strong>Thorn:</strong> Hardest part of your week.",
                "üå± <strong>Bud:</strong> What are you looking forward to?"
            ],
            iceBreakers: [
                "If you could have a walk-up song play every time you entered a room, what would it be?",
                "What's a small thing that happened this week that made you happy?",
                "If you could instantly become an expert in one thing, what would it be?",
                "What's the most interesting thing you've learned recently?",
                "If you could talk to animals, which animal would you have the most interesting conversation with?",
                "What's a fictional world you would love to live in for a week?",
                "If you had to describe our family as a type of food, what would we be?",
                "What's a weird food combination that you secretly love?",
                "If you could add a new, magical room to our house, what would it be?",
                "What movie or TV show character do you think is most like you?",
                "If you could design a new planet, what would be its main feature?",
                "What's the best smell in the world?",
                "What's a family tradition you think we should start?",
                "If you could create a new holiday, what would it celebrate?",
                "What's the funniest thing that's ever happened to you?",
                "If you could have any job for just one day, what would you choose?",
                "What's something you're really proud of that you did this week?",
                "If you could have any mythical creature as a pet, what would it be?",
                "What's the most beautiful place you've ever seen?",
                "If you could solve one of the world's mysteries, which one would you pick?",
                "What's one thing you hope to accomplish in the next year?",
                "If you could have a super-power that was only useful for doing chores, what would it be?",
                "What's your favorite thing about the person sitting to your left?",
                "If you could be a movie director, what kind of movie would you make?",
                "What's a word you love the sound of?",
                "If you could have a dinner party with three characters from books, who would you invite?",
                "What's a simple pleasure that always makes your day better?",
                "If our family was a sports team, what would our team name be?",
                "What's the best piece of advice you've ever received?",
                "If you could only listen to three songs for the rest of your life, what would they be?",
                "What's something you're looking forward to this month?",
                "If you could have a conversation with any historical figure, who would it be?",
                "What's the most interesting dream you've had recently?",
                "If you had to eat one color of food for a whole day, which color would you choose?",
                "What's something that always makes you laugh without fail?",
                "If you could be a world-famous expert on any topic, what would it be?",
                "What's your favorite memory of just our family?",
                "If you could design a new ride for an amusement park, what would it do?",
                "What's a small act of kindness you saw or did this week?",
                "If you could instantly learn any musical instrument, which one would you pick?",
                "What's the best part about being your current age?",
                "If you could have a magical portal in your room, where would it lead?",
                "What's a question you wish people would ask you more often?",
                "If you could create a new flavor of chips or ice cream, what would it be?",
                "What's a skill you think everyone in our family should learn?",
                "If you could be the main character in any video game, which one would it be?",
                "If you could combine two animals to make one new super-animal, what would you combine?",
                "What's a food that you think is seriously underrated?",
                "If you could have any view from your bedroom window, what would it be?",
                "What's something you've done that you thought was impossible at first?",
                "What's something you're really good at that might surprise people?",
                "If you could have any artist's musical talent, whose would you choose?",
                "If you could ask your future self one question, what would it be?",
                "If you were a color, what color would you be and why?",
                "What is your favorite item of clothing you own?",
                "If you could master one instrument instantly, which one?",
                "What is the first thing you notice about a person?",
                "What is your favorite board game?",
                "If you could invent a gadget, what would it do?",
                "What is the best gift you have ever given?",
                "If you could pause time for one hour a day, what would you do?"
            ],
            dynamics: [ // Moral Stories
                { title: "The Lion and the Mouse", body: "A lion spared a mouse. Later, the lion was trapped in a net. The mouse chewed the ropes to free him. Moral: Little friends may prove great friends." },
                { title: "The Tortoise and the Hare", body: "The hare bragged about speed and took a nap. The tortoise kept moving slow and steady. The tortoise won. Moral: Consistency beats intensity." },
                { title: "The Boy Who Cried Wolf", body: "A boy lied about a wolf attacking. When a real wolf came, no one believed him. Moral: Liars are not believed even when they speak the truth." },
                { title: "The Bundle of Sticks", body: "A father showed his sons that a single stick breaks easily, but a bundle is unbreakable. Moral: Unity is strength." },
                { title: "The Ant and the Grasshopper", body: "The ant worked all summer storing food. The grasshopper played. In winter, the ant was safe, the grasshopper starved. Moral: Work today for a better tomorrow." },
                { title: "The Dog and the Shadow", body: "A dog with a bone saw his reflection in the water. He thought the 'other dog' had a bigger bone. He barked to get it and dropped his own bone in the river. Moral: Greed causes you to lose what you have." },
                { title: "The Crow and the Pitcher", body: "A thirsty crow found a pitcher with water at the bottom. He couldn't reach it. He dropped stones in one by one until the water rose to the top. Moral: Little by little does the trick." },
                { title: "The Wind and the Sun", body: "They bet on who could make a man take off his coat. The Wind blew hard, the man held tight. The Sun shone warmly, the man took it off. Moral: Gentleness is stronger than force." },
                { title: "The Fox and the Grapes", body: "A fox tried to reach hanging grapes but failed. He walked away saying, 'They were probably sour anyway.' Moral: It is easy to despise what you cannot have." },
                { title: "The Two Goats", body: "Two goats met on a narrow bridge. Neither would move back. They locked horns and both fell into the river. Moral: Stubbornness leads to disaster." },
                { title: "The Milkmaid", body: "A girl carried milk on her head, dreaming of selling it to buy eggs, then chicks, then a dress. She tossed her head in excitement and spilled the milk. Moral: Don't count your chickens before they hatch." },
                { title: "The Golden Goose", body: "A man had a goose that laid golden eggs. Impatient to get all the gold, he killed it, only to find it was empty inside. Moral: Greed destroys the source of good." },
                { title: "The Oak and the Reed", body: "A strong oak boasted it could stand any storm. A thin reed said it would bend. The storm came; the oak broke, the reed bent and survived. Moral: Flexibility is stronger than rigidity." },
                { title: "The Miller, Son, and Donkey", body: "A man and son tried to please everyone while walking their donkey. They carried it, rode it, walked it. In the end, they pleased no one and lost the donkey. Moral: Try to please everyone and you please no one." },
                { title: "The Fox and the Crow", body: "A crow had cheese. A fox flattered her singing voice. The crow opened her mouth to sing and dropped the cheese. Moral: Beware of flatterers." },
                { title: "The Empty Pot", body: "The Emperor gave seeds to children to see who could grow the best flower. One boy's seed never grew. He brought the empty pot. The Emperor rewarded his honesty because the seeds were cooked. Moral: Honesty is better than success based on lies." },
                { title: "The Stone Soup", body: "Travelers arrived in a village with nothing but a pot. They boiled a stone. Villagers grew curious and added carrots, then potatoes, then meat. Soon, the whole village shared a feast. Moral: Sharing creates abundance from nothing." },
                { title: "The Elephant and the Rope", body: "A huge elephant was tied by a small rope. It didn't break it because as a baby, it learned it couldn't. It never tried again. Moral: Do not let past failure limit your future power." },
                { title: "The Starfish Story", body: "A man saw a boy throwing starfish back into the sea. 'There are thousands,' said the man, 'You can't make a difference.' The boy threw one more. 'I made a difference to that one.' Moral: Every small act matters." },
                { title: "The Farmer and the Horse", body: "A farmer's horse ran away. Neighbors said 'Bad luck.' Farmer said 'Maybe.' Horse returned with wild horses. 'Good luck.' 'Maybe.' Son broke leg riding. 'Bad luck.' 'Maybe.' Army draft skipped son due to leg. Moral: Do not judge events too quickly; we do not know the end." }
            ],
            skills: [
                { title: "The Perfect Handshake", body: "Stand up. Make eye contact. Smile. Grip firmly (web to web). Shake twice. Release. It builds instant respect." },
                { title: "The 2-Minute Rule", body: "If a task takes less than 2 minutes (hanging a coat, washing a dish), do it immediately. Never add it to a to-do list." },
                { title: "Active Listening", body: "When someone talks, look at them. Do not think about your response. Just listen. When they finish, ask one question about what they said." },
                { title: "Box Breathing", body: "Anxiety hack: Breathe in for 4 seconds. Hold for 4 seconds. Exhale for 4 seconds. Hold for 4 seconds. Repeat." },
                { title: "How to Apologize", body: "A real apology has 3 parts: 1. 'I am sorry.' 2. 'It was my fault because...' 3. 'Next time I will...' Without part 3, it is just an excuse." },
                { title: "Budgeting 50/30/20", body: "Money rule: 50% for Needs (Rent/Food). 30% for Wants (Fun). 20% for Savings. Always pay your savings first." },
                { title: "Tying a Square Knot", body: "Right over Left. Left over Right. This knot will not slip, but is easy to untie. It is the most useful knot in the world." },
                { title: "Table Manners", body: "Wait until everyone is served before eating. Chew with your mouth closed. Keep elbows off the table while eating. It shows respect for the cook." },
                { title: "The Gratitude Pivot", body: "When you complain ('I have to go to school'), switch 'Have' to 'Get'. 'I GET to go to school.' It changes your brain chemistry." },
                { title: "Changing a Tire", body: "Loosen nuts BEFORE jacking up the car. Jack it up. Remove nuts. Swap tire. Tighten nuts by hand. Lower car. Tighten nuts fully." },
                { title: "How to Introduce People", body: "Say the name of the older/higher status person first. 'Grandma, this is my friend Sam.' It shows social grace." },
                { title: "Sewing a Button", body: "Thread needle. Knot end. Go up through hole, down through other. Repeat 6 times. Wrap thread around the 'neck' of button. Tie off." },
                { title: "Map Reading", body: "Find North. Orient the map so it matches the land in front of you. Don't just follow the blue dot." },
                { title: "Making a Bed", body: "Hospital corners: Tuck the foot. Lift the side of the sheet, tuck the excess triangle under, then drop the side. Crisp and tight." },
                { title: "Remembering Names", body: "When introduced, say their name back immediately. 'Nice to meet you, Sarah.' Visualize 'Sarah' written on her forehead." },
                { title: "Writing a Thank You Note", body: "1. Salutation. 2. Mention the specific gift. 3. Say how you will use it. 4. Mention seeing them soon. 5. Sign off." },
                { title: "Doing Laundry", body: "Separate lights and darks. Check pockets! Use cold water to save energy and clothes. Fold immediately to avoid wrinkles." },
                { title: "Scrambling an Egg", body: "Low heat is key. Whisk with a splash of milk. Pour into buttered pan. Push gently with spatula. Don't overcook!" },
                { title: "Plunging a Toilet", body: "Ensure water covers the cup. Push down gently to release air, then pull up and push down vigorously. Repeat until water drains." },
                { title: "Identifying Poison Ivy", body: "Leaves of three, let it be. Hairy vine, no friend of mine. If it looks shiny or oily, stay away." }
            ]
        },
        friends: {
            title: "Social Deck",
            subtitle: "Less scrolling, more talking.",
            tags: ["Vibe Check", "Highs & Lows", "Hot Takes", "Party Trick"],
            btns: ["Get Question", "New Debate", "Get Trick"],
            checkin: [
                "üî• <strong>Fire:</strong> Best thing recently.",
                "üßä <strong>Ice:</strong> Something annoying.",
                "üç∫ <strong>Drink:</strong> What are we drinking?"
            ],
            iceBreakers: [
                "Worst date you've ever been on?", "What is a 'Red Flag' you ignore in dating?", 
                "If you won the lottery, what's the first thing you buy?", "Who here would die first in a zombie apocalypse?",
                "What is your go-to karaoke song?", "What is the weirdest thing you find attractive?",
                "If you could get away with a crime, what would it be?", "What was your most embarrassing moment in high school?",
                "If you could swap lives with one celebrity, who would it be?", "What is your guilty pleasure TV show?",
                "If you could punch one person in the face without consequences, who?", "What is the worst trend you ever followed?",
                "If you were an alcoholic drink, what would you be?", "What is your biggest pet peeve?",
                "If you could have dinner with three people (dead or alive), who?", "What is the best concert you have ever been to?",
                "What is the most expensive thing you have broken?", "Have you ever ghosted someone?",
                "What is a lie you tell often?", "What is the craziest thing you have done for love?",
                "What is your unpopular food opinion?", "Who is your celebrity crush?", "What's the worst advice you've ever taken?",
                "Have you ever been caught doing something you shouldn't?", "What is the strangest rumor you've heard about yourself?",
                "What is your signature dance move?", "If you had to marry one person in this room, who?",
                "What is the most illegal thing you have done?", "What is a secret talent you have?",
                "Who was your first crush?"
            ],
            dynamics: [ // HOT TAKES
                { title: "Debate:", body: "Is a hotdog a sandwich?" },
                { title: "Debate:", body: "Does pineapple belong on pizza?" },
                { title: "Debate:", body: "Is it better to text or call?" },
                { title: "Debate:", body: "Are leggings pants?" },
                { title: "Debate:", body: "Is water wet?" },
                { title: "Debate:", body: "Toilet paper: Over or Under?" },
                { title: "Debate:", body: "Is Die Hard a Christmas movie?" },
                { title: "Debate:", body: "Should you wash your legs in the shower?" },
                { title: "Debate:", body: "Is cereal soup?" },
                { title: "Debate:", body: "Is a taco a sandwich?" },
                { title: "Debate:", body: "Friends (TV Show): Overrated or Underrated?" },
                { title: "Debate:", body: "Cats vs Dogs: Who is actually better?" },
                { title: "Debate:", body: "Is it okay to recline your seat on an airplane?" },
                { title: "Debate:", body: "Should you tip on takeout orders?" },
                { title: "Debate:", body: "Is deep dish pizza essentially a casserole?" },
                { title: "Debate:", body: "Are ghosts real?" },
                { title: "Debate:", body: "Does the person who pays on a date get to order?" },
                { title: "Debate:", body: "Is it okay to wear socks with sandals?" },
                { title: "Debate:", body: "Best potato form: Fry, Mash, or Chip?" },
                { title: "Debate:", body: "Is it cheating if it's in a different area code?" }
            ],
            skills: [ // PARTY TRICKS
                { title: "Open a Bottle Without a Opener", body: "Use the edge of a lighter or a spoon as a lever under the cap." },
                { title: "The Perfect High Five", body: "Look at the other person's ELBOW, not their hand. You will never miss." },
                { title: "Saber a Champagne Bottle", body: "Find the seam of the bottle. Chill the neck. Slide a blunt knife along the seam and hit the lip firmly." },
                { title: "Exit a Boring Conversation", body: "Say 'I need to grab a drink/food/bathroom' or 'I see [Name], I need to say hi.'" },
                { title: "Remove Red Wine Stains", body: "Pour white wine or salt on the stain immediately to absorb it." },
                { title: "Whistle with Fingers", body: "Make an 'A' shape with index and middle fingers. Fold tongue back. Blow over the tongue." },
                { title: "Rip an Apple in Half", body: "Grip apple with palms, thumbs on top. Pull apart with chest muscles, rolling palms outward." },
                { title: "Coin Knuckle Roll", body: "Balance coin on index finger. Use thumb to push it over middle finger. Catch with ring finger. Practice." },
                { title: "Zippo Snap Start", body: "Hold Zippo by the lid. Snap fingers, hitting the wheel. It lights instantly." },
                { title: "Beer Mat Flip", body: "Place beer mat on edge of table. Flip it 180 degrees with back of hand and catch it." }
            ]
        },
        work: {
            title: "Team Sync",
            subtitle: "Align goals, remove blockers.",
            tags: ["Warm Up", "Stand-Up", "Discussion", "Productivity"],
            btns: ["Get Question", "New Topic", "Get Tip"],
            checkin: [
                "‚úÖ <strong>Done:</strong> What did you ship?",
                "üöß <strong>Doing:</strong> What is in progress?",
                "üõë <strong>Blocker:</strong> What is stopping you?"
            ],
            iceBreakers: [
                "What was your first job?", "What is one productivity tool you can't live without?", 
                "Coffee or Tea?", "Best career advice you ever received?", "What is your favorite way to decompress after work?",
                "If you could work from anywhere, where would it be?", "What is one skill you want to learn this year?",
                "What was the first thing you bought with your own money?", "Who is a mentor you admire?",
                "What is the best team you have ever been a part of?", "What is your preferred communication style?",
                "Morning lark or night owl?", "What is one book that changed your thinking?",
                "If you weren't in this career, what would you be doing?", "What is your favorite office snack?",
                "How do you handle stress?", "What is one thing you are proud of accomplishing this month?",
                "What is your desktop wallpaper?", "Do you prefer open office or private office?",
                "What is one thing you would change about our industry?",
                "What is the most valuable lesson you've learned from a mistake?",
                "If you could have a 3-day weekend or higher pay, which?"
            ],
            dynamics: [ // WORK TOPICS
                { title: "Process Check", body: "Is there a meeting we should cancel?" },
                { title: "Risk Assessment", body: "What is the biggest risk to our current deadline?" },
                { title: "Kudos", body: "Who deserves a shoutout this week?" },
                { title: "Retrospective", body: "What went well this sprint?" },
                { title: "Retrospective", body: "What didn't go well this sprint?" },
                { title: "Innovation", body: "What is one crazy idea we haven't tried?" },
                { title: "Customer Focus", body: "What is the biggest complaint we hear from customers?" },
                { title: "Culture", body: "How can we improve our team culture?" },
                { title: "Learning", body: "What is a mistake we made that we can learn from?" },
                { title: "Future", body: "Where do we want to be in 6 months?" },
                { title: "Communication", body: "Are we communicating too much or too little?" },
                { title: "Tools", body: "Is there a tool that is slowing us down?" },
                { title: "Wellbeing", body: "Is everyone managing their workload okay?" },
                { title: "Onboarding", body: "How can we make new hires feel more welcome?" },
                { title: "Priorities", body: "Are we focused on the right things right now?" }
            ],
            skills: [ // PRODUCTIVITY
                { title: "Box Breathing", body: "In for 4s, Hold for 4s, Out for 4s, Hold for 4s. Great for stress." },
                { title: "Inbox Zero", body: "Touch every email once. Delete, Delegate, Do (if <2mins), or Defer." },
                { title: "The Pomodoro Technique", body: "25 minutes of focus, 5 minutes of break. Repeat." },
                { title: "Time Blocking", body: "Schedule your day in blocks. Don't let your inbox dictate your schedule." },
                { title: "Saying No", body: "Politely decline tasks that don't align with your goals. 'I can't prioritize that right now.'" },
                { title: "Efficient Meetings", body: "No agenda, no meeting. Always end with clear action items." },
                { title: "Deep Work", body: "Eliminate distractions for 90 minutes to focus on hard problems." },
                { title: "The 80/20 Rule", body: "20% of your efforts produce 80% of your results. Focus on the 20%." },
                { title: "Feedback Sandwich", body: "Positive feedback, constructive criticism, positive feedback. (Use sparingly)." },
                { title: "Active Listening", body: "Listen to understand, not to reply." },
                { title: "The Eisenhower Matrix", body: "Sort tasks: Urgent/Important (Do), Not Urgent/Important (Plan), Urgent/Not Important (Delegate), Neither (Delete)." },
                { title: "Batching", body: "Group similar tasks (email, admin) and do them all at once." },
                { title: "Two-Screen Setup", body: "Use one screen for reference, one for working. Increases efficiency." },
                { title: "Stand and Stretch", body: "Every hour, stand up. Your brain needs blood flow to function." },
                { title: "Keyboard Shortcuts", body: "Learn Ctrl+C, Ctrl+V, Alt-Tab. Saving seconds adds up to hours." }
            ]
        }
    };

    // --- STATE & UTILS ---
    let currentMode = 'family';
    let usedIndices = { iceBreaker: [], dynamic: [], skill: [] };

    window.onload = () => {
        const saved = localStorage.getItem('mode');
        setMode(saved || 'family');
        const notes = localStorage.getItem('notes');
        if(notes) document.getElementById('notes').value = notes;
    };

    // Auto-save notes
    document.getElementById('notes').addEventListener('input', (e) => {
        localStorage.setItem('notes', e.target.value);
    });

    function setMode(mode) {
        currentMode = mode;
        localStorage.setItem('mode', mode);
        document.body.setAttribute('data-mode', mode);
        
        // Update Tabs
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('tab-' + mode).classList.add('active');

        // Update Text
        const d = db[mode];
        document.getElementById('app-title').innerText = d.title;
        document.querySelector('.subtitle').innerText = d.subtitle;
        
        // Update Tags & Buttons
        document.getElementById('tag-1').innerText = d.tags[0];
        document.getElementById('tag-2').innerText = d.tags[1];
        document.getElementById('tag-3').innerText = d.tags[2];
        document.getElementById('tag-4').innerText = d.tags[3];
        
        document.getElementById('btn-1').innerText = d.btns[0];
        document.getElementById('btn-3').innerText = d.btns[1];
        document.getElementById('btn-4').innerText = d.btns[2];

        // Update Checkin List
        const list = document.getElementById('list-checkin');
        list.innerHTML = '';
        d.checkin.forEach(item => {
            const li = document.createElement('li');
            li.innerHTML = item;
            list.appendChild(li);
        });

        // Reset Content
        document.getElementById('content-iceBreaker').innerHTML = "<p>Tap to start...</p>";
        document.getElementById('content-dynamic').innerHTML = "<p>Tap to start...</p>";
        document.getElementById('content-skill').innerHTML = "<p>Tap to start...</p>";
        
        // Reset Logic
        usedIndices = { iceBreaker: [], dynamic: [], skill: [] };
    }

    function generate(type) {
        const d = db[currentMode];
        let pool = [];
        
        if (type === 'iceBreaker') pool = d.iceBreakers;
        else if (type === 'dynamic') pool = d.dynamics;
        else if (type === 'skill') pool = d.skills;

        // No repeats logic
        let index;
        let attempts = 0;
        do {
            index = Math.floor(Math.random() * pool.length);
            attempts++;
        } while (usedIndices[type].includes(index) && attempts < 50);
        
        usedIndices[type].push(index);
        const item = pool[index];
        const container = document.getElementById('content-' + type);

        // Render
        if (typeof item === 'string') {
            container.innerHTML = `<p>${item}</p>`;
        } else {
            container.innerHTML = `<h3>${item.title}</h3><p>${item.body}</p>`;
        }
    }

    function generateJoke() {
        const container = document.getElementById('content-joke');
        container.innerHTML = "Thinking...";
        fetch('https://official-joke-api.appspot.com/random_joke')
            .then(r => r.json())
            .then(data => {
                container.innerHTML = `<p><strong>${data.setup}</strong><br><em>${data.punchline}</em></p>`;
            })
            .catch(() => {
                container.innerHTML = "<p>Why did the developer go broke? He used up all his cache.</p>";
            });
    }

    function generateOrder() {
        const count = document.getElementById('participantCount').value;
        if(!count || count < 2) return alert("Enter at least 2 people");
        let arr = [];
        for(let i=1; i<=count; i++) arr.push(i);
        arr.sort(() => Math.random() - 0.5);
        document.getElementById('checkInOrder').innerText = "Order: Person " + arr.join(" ‚Üí ");
    }

    function copyNotes() {
        const notes = document.getElementById('notes').value;
        navigator.clipboard.writeText(notes);
        const t = document.getElementById('toast');
        t.className = "show";
        setTimeout(() => t.className = "", 3000);
    }
</script>

</body>
</html>
